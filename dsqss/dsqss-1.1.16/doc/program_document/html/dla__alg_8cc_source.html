<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>DSQSS: dla_alg.cc „ÇΩ„Éº„Çπ„Éï„Ç°„Ç§„É´</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">DSQSS
   &#160;<span id="projectnumber">1.1</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- ‰ΩúÊàêÔºö Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Ê§úÁ¥¢');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>„É°„Ç§„É≥„Éö„Éº„Ç∏</span></a></li>
      <li><a href="namespaces.html"><span>„Éç„Éº„É†„Çπ„Éö„Éº„Çπ</span></a></li>
      <li><a href="annotated.html"><span>„ÇØ„É©„Çπ</span></a></li>
      <li class="current"><a href="files.html"><span>„Éï„Ç°„Ç§„É´</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Ê§úÁ¥¢" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>„Éï„Ç°„Ç§„É´‰∏ÄË¶ß</span></a></li>
      <li><a href="globals.html"><span>„Éï„Ç°„Ç§„É´„É°„É≥„Éê</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('dla__alg_8cc.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">dla_alg.cc</div>  </div>
</div><!--header-->
<div class="contents">
<a href="dla__alg_8cc.html">Ë™¨Êòé„ÇíË¶ã„Çã„ÄÇ</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 
<a name="l00002"></a>00002 <span class="preprocessor">#include &quot;<a class="code" href="dla__alg_8h.html">dla_alg.h</a>&quot;</span>
<a name="l00003"></a>00003 
<a name="l00004"></a>00004 <span class="comment">//######################################################################</span>
<a name="l00005"></a>00005 
<a name="l00006"></a><a class="code" href="dla__alg_8cc.html#a3c04138a5bfe5d72780bb7e82a18e627">00006</a> <span class="keywordtype">int</span> <a class="code" href="dla_8cc.html#a0ddf1224851353fc92bfbff6f499fa97">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>** argv) {
<a name="l00007"></a>00007 
<a name="l00008"></a>00008   <a class="code" href="dla__alg_8h.html#a0cf1e245578b90cf6a25562a673fb667">HFILE</a> = <span class="stringliteral">&quot;hamiltonian.xml&quot;</span>; 
<a name="l00009"></a>00009   <a class="code" href="dla__alg_8h.html#aac2cb90ac28c35a4c4c2d1df5f4a4dbf">AFILE</a> = <span class="stringliteral">&quot;algorithm.xml&quot;</span>; 
<a name="l00010"></a>00010   <span class="keywordflow">if</span> ( argc &gt; 1 ) { <a class="code" href="dla__alg_8h.html#a0cf1e245578b90cf6a25562a673fb667">HFILE</a> = argv[1]; }
<a name="l00011"></a>00011   <span class="keywordflow">if</span> ( argc &gt; 2 ) { <a class="code" href="dla__alg_8h.html#aac2cb90ac28c35a4c4c2d1df5f4a4dbf">AFILE</a> = argv[2]; }
<a name="l00012"></a>00012   printf(<span class="stringliteral">&quot;HFILE= %s\n&quot;</span>, <a class="code" href="dla__alg_8h.html#a0cf1e245578b90cf6a25562a673fb667">HFILE</a>);
<a name="l00013"></a>00013   printf(<span class="stringliteral">&quot;AFILE= %s\n&quot;</span>, <a class="code" href="dla__alg_8h.html#aac2cb90ac28c35a4c4c2d1df5f4a4dbf">AFILE</a>);
<a name="l00014"></a>00014 
<a name="l00015"></a>00015   <span class="comment">// ÉtÉ@ÉCÉãÇ XML ÉIÉuÉWÉFÉNÉgÇ…ì«Ç›çûÇﬁ</span>
<a name="l00016"></a>00016 
<a name="l00017"></a>00017   <a class="code" href="classXML_1_1Block.html">XML::Block</a> X(<a class="code" href="dla__alg_8h.html#a0cf1e245578b90cf6a25562a673fb667">HFILE</a>,<span class="stringliteral">&quot;Hamiltonian&quot;</span>);
<a name="l00018"></a>00018   <a class="code" href="dla__alg_8h.html#a58060d07f59ce3eff252924cf18e5d39">FALG</a> = fopen(<a class="code" href="dla__alg_8h.html#aac2cb90ac28c35a4c4c2d1df5f4a4dbf">AFILE</a>,<span class="stringliteral">&quot;w&quot;</span>);
<a name="l00019"></a>00019 <span class="comment">//FALG = stdout;</span>
<a name="l00020"></a>00020 
<a name="l00021"></a>00021   <a class="code" href="classXML_1_1Block.html">XML::Block</a>&amp; XGEN = X[<span class="stringliteral">&quot;General&quot;</span>];
<a name="l00022"></a>00022   <a class="code" href="classGENERAL.html">GENERAL</a> G(XGEN);
<a name="l00023"></a>00023   <a class="code" href="classSite.html">Site</a>        = <span class="keyword">new</span> <a class="code" href="classSITE.html">SITE</a>[<a class="code" href="dla__alg_8h.html#a2dad84a8985d20913d523848ae5e40ea">NSTYPE</a>];
<a name="l00024"></a>00024   <a class="code" href="dla__alg_8h.html#a35f116b5f6905f314bc3858998e27dd2">Source</a>      = <span class="keyword">new</span> <a class="code" href="classSOURCE.html">SOURCE</a>[<a class="code" href="dla__alg_8h.html#a2dad84a8985d20913d523848ae5e40ea">NSTYPE</a>];
<a name="l00025"></a>00025   <a class="code" href="classInteraction.html">Interaction</a> = <span class="keyword">new</span> <a class="code" href="classINTERACTION.html">INTERACTION</a>[<a class="code" href="dla__alg_8h.html#a28e1a55e45e45a80a49a8ae1f0e50bcb">NITYPE</a>];
<a name="l00026"></a>00026   <a class="code" href="classVertex.html">Vertex</a>      = <span class="keyword">new</span> <a class="code" href="classVERTEX.html">VERTEX</a>[<a class="code" href="dla__alg_8h.html#ab6af66382562de2aa8b45b81e256d909">NVTYPE</a>];
<a name="l00027"></a>00027 
<a name="l00028"></a>00028   <span class="comment">// äeëÆê´ÉIÉuÉWÉFÉNÉgÇÃÉZÉbÉg</span>
<a name="l00029"></a>00029 
<a name="l00030"></a>00030   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;X.<a class="code" href="classXML_1_1Block.html#a88796becd473f212deb450ad1a31a893">NumberOfBlocks</a>(); i++) {
<a name="l00031"></a>00031     <a class="code" href="classXML_1_1Block.html">XML::Block</a>&amp; B = X[i];
<a name="l00032"></a>00032     <span class="keyword">const</span> <span class="keywordtype">string</span>&amp; name = B.<a class="code" href="classXML_1_1Block.html#a8cf4db36c9f3123506d73e98c4a93464">getName</a>();
<a name="l00033"></a>00033     <span class="keywordflow">if</span> ( name == <span class="stringliteral">&quot;Site&quot;</span> ) { 
<a name="l00034"></a>00034       <span class="keywordtype">int</span> <span class="keywordtype">id</span> = B[<span class="stringliteral">&quot;STYPE&quot;</span>].<a class="code" href="classXML_1_1Block.html#afcd6370972fce7a0d9378c778f5f09c7">getInteger</a>();
<a name="l00035"></a>00035       <a class="code" href="classSite.html">Site</a>[id].load(B);
<a name="l00036"></a>00036       <span class="comment">//      Site[id].dump();</span>
<a name="l00037"></a>00037     }
<a name="l00038"></a>00038     <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( name == <span class="stringliteral">&quot;Source&quot;</span> ) { 
<a name="l00039"></a>00039       <span class="keywordtype">int</span> <span class="keywordtype">id</span> = B[<span class="stringliteral">&quot;TTYPE&quot;</span>].<a class="code" href="classXML_1_1Block.html#afcd6370972fce7a0d9378c778f5f09c7">getInteger</a>();
<a name="l00040"></a>00040       <a class="code" href="dla__alg_8h.html#a35f116b5f6905f314bc3858998e27dd2">Source</a>[id].<a class="code" href="classSOURCE.html#af8b2b5aa28e95ab6c30d43fd63cb4723">load</a>(B);
<a name="l00041"></a>00041       <span class="comment">//      Source[id].dump();</span>
<a name="l00042"></a>00042       <span class="comment">//      Vertex[Source[id].VTYPE].dump();</span>
<a name="l00043"></a>00043     }
<a name="l00044"></a>00044     <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( name == <span class="stringliteral">&quot;Interaction&quot;</span> ) { 
<a name="l00045"></a>00045       <span class="keywordtype">int</span> <span class="keywordtype">id</span> = B[<span class="stringliteral">&quot;ITYPE&quot;</span>].<a class="code" href="classXML_1_1Block.html#afcd6370972fce7a0d9378c778f5f09c7">getInteger</a>();
<a name="l00046"></a>00046       <a class="code" href="classInteraction.html">Interaction</a>[id].load(B);
<a name="l00047"></a>00047       <span class="comment">//      Interaction[id].dump();</span>
<a name="l00048"></a>00048       <span class="comment">//      Vertex[Interaction[id].VTYPE].dump();</span>
<a name="l00049"></a>00049     }
<a name="l00050"></a>00050   }
<a name="l00051"></a>00051 
<a name="l00052"></a>00052   <span class="comment">// éUóêämó¶ÇÃåvéZ</span>
<a name="l00053"></a>00053 
<a name="l00054"></a>00054   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="dla__alg_8h.html#ab6af66382562de2aa8b45b81e256d909">NVTYPE</a>; i++) {
<a name="l00055"></a>00055     <a class="code" href="classVertex.html">Vertex</a>[i].Grouping();
<a name="l00056"></a>00056   }
<a name="l00057"></a>00057   <span class="comment">// ÉèÅ[ÉÄÇÃê∂ê¨è¡ñ≈Ç…ëŒâûÇ∑ÇÈÉoÅ[ÉeÉbÉNÉXÇ≈ÇÕã§í ÇÃ EBASE ÇégÇ§ÅD</span>
<a name="l00058"></a>00058   G.<a class="code" href="classGENERAL.html#a7c8080b243082b92783a87fc337edbda">WeightDiagonal</a> = -<a class="code" href="name_8h.html#a12c2040f25d8e3a7b9e1c2024c618cb6">INF</a>;
<a name="l00059"></a>00059 
<a name="l00060"></a>00060   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="dla__alg_8h.html#a2dad84a8985d20913d523848ae5e40ea">NSTYPE</a>; i++) {
<a name="l00061"></a>00061     <a class="code" href="classVERTEX.html">VERTEX</a>&amp; V = <a class="code" href="classSite.html">Site</a>[i].V();
<a name="l00062"></a>00062     <span class="keywordtype">double</span> eb = V.<a class="code" href="classVERTEX.html#aa6f8348a028e6d508a0d2571119d0463">ComputeEBASE</a>();
<a name="l00063"></a>00063     <span class="keywordflow">if</span> ( G.<a class="code" href="classGENERAL.html#a7c8080b243082b92783a87fc337edbda">WeightDiagonal</a> &lt; 0.5 * eb ) G.<a class="code" href="classGENERAL.html#a7c8080b243082b92783a87fc337edbda">WeightDiagonal</a> = 0.5 * eb;
<a name="l00064"></a>00064   }
<a name="l00065"></a>00065 
<a name="l00066"></a>00066   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="dla__alg_8h.html#a2dad84a8985d20913d523848ae5e40ea">NSTYPE</a>; i++) {
<a name="l00067"></a>00067     <a class="code" href="classVERTEX.html">VERTEX</a>&amp; V = <a class="code" href="classSite.html">Site</a>[i].V();
<a name="l00068"></a>00068     V.<a class="code" href="classVERTEX.html#ad5f4f052b92013a850af5f9ea527d8b5">EBASE</a> = 2.0 * G.<a class="code" href="classGENERAL.html#a7c8080b243082b92783a87fc337edbda">WeightDiagonal</a>;
<a name="l00069"></a>00069   }
<a name="l00070"></a>00070 
<a name="l00071"></a>00071   <span class="comment">// ëäå›çÏópÇ…ëŒâûÇ∑ÇÈÉoÅ[ÉeÉbÉNÉXÇ≈ÇÕÇªÇÍÇºÇÍå¬ï ÇÃ EBASE ÇégÇ§ÅD</span>
<a name="l00072"></a>00072 
<a name="l00073"></a>00073   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="dla__alg_8h.html#a28e1a55e45e45a80a49a8ae1f0e50bcb">NITYPE</a>; i++) {
<a name="l00074"></a>00074     <a class="code" href="classVERTEX.html">VERTEX</a>&amp; V = <a class="code" href="classInteraction.html">Interaction</a>[i].V();
<a name="l00075"></a>00075     V.<a class="code" href="classVERTEX.html#ad5f4f052b92013a850af5f9ea527d8b5">EBASE</a> = V.<a class="code" href="classVERTEX.html#aa6f8348a028e6d508a0d2571119d0463">ComputeEBASE</a>();
<a name="l00076"></a>00076   }
<a name="l00077"></a>00077 
<a name="l00078"></a>00078   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="dla__alg_8h.html#ab6af66382562de2aa8b45b81e256d909">NVTYPE</a>; i++) <a class="code" href="classVertex.html">Vertex</a>[i].ComputeScatteringProbability();
<a name="l00079"></a>00079 
<a name="l00080"></a>00080   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="dla__alg_8h.html#a2dad84a8985d20913d523848ae5e40ea">NSTYPE</a>; i++) {
<a name="l00081"></a>00081     <a class="code" href="classSite.html">Site</a>[i].SetInitialHeadTypeProbability();
<a name="l00082"></a>00082   }
<a name="l00083"></a>00083 
<a name="l00084"></a>00084   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="dla__alg_8h.html#a28e1a55e45e45a80a49a8ae1f0e50bcb">NITYPE</a>; i++) {
<a name="l00085"></a>00085     <a class="code" href="classInteraction.html">Interaction</a>[i].SetVertexDensity();
<a name="l00086"></a>00086   }
<a name="l00087"></a>00087 
<a name="l00088"></a>00088   <span class="comment">// ÉtÉ@ÉCÉãÇ÷ÇÃèëÇ´èoÇµ</span>
<a name="l00089"></a>00089 
<a name="l00090"></a>00090   fprintf(<a class="code" href="dla__alg_8h.html#a58060d07f59ce3eff252924cf18e5d39">FALG</a>,<span class="stringliteral">&quot;&lt;Algorithm&gt;\n&quot;</span>);
<a name="l00091"></a>00091   G.<a class="code" href="classGENERAL.html#aac759501cf6c7895a70eecbef0226ae1">write</a>();
<a name="l00092"></a>00092   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="dla__alg_8h.html#a2dad84a8985d20913d523848ae5e40ea">NSTYPE</a>; i++) <a class="code" href="classSite.html">Site</a>[i].write();
<a name="l00093"></a>00093   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="dla__alg_8h.html#a28e1a55e45e45a80a49a8ae1f0e50bcb">NITYPE</a>; i++) <a class="code" href="classInteraction.html">Interaction</a>[i].write();
<a name="l00094"></a>00094   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="dla__alg_8h.html#ab6af66382562de2aa8b45b81e256d909">NVTYPE</a>; i++) <a class="code" href="classVertex.html">Vertex</a>[i].write();
<a name="l00095"></a>00095   fprintf(<a class="code" href="dla__alg_8h.html#a58060d07f59ce3eff252924cf18e5d39">FALG</a>,<span class="stringliteral">&quot;\n&lt;/Algorithm&gt;\n&quot;</span>);
<a name="l00096"></a>00096 
<a name="l00097"></a>00097   <span class="keyword">delete</span> [] <a class="code" href="dla__alg_8h.html#af3e32ba4d1b055ad90d8eea747a9930a">Site</a>;
<a name="l00098"></a>00098   <span class="keyword">delete</span> [] <a class="code" href="dla__alg_8h.html#a35f116b5f6905f314bc3858998e27dd2">Source</a>;
<a name="l00099"></a>00099   <span class="keyword">delete</span> [] <a class="code" href="dla__alg_8h.html#a9a71a3dd3f6578bf2688d995db18b8b5">Interaction</a>;
<a name="l00100"></a>00100   <span class="keyword">delete</span> [] <a class="code" href="dla__alg_8h.html#a58373c1e7631a87ad7e2c548d568d03c">Vertex</a>;
<a name="l00101"></a>00101 
<a name="l00102"></a>00102 }
<a name="l00103"></a>00103 
<a name="l00104"></a>00104 <span class="comment">//######################################################################</span>
<a name="l00105"></a>00105 
<a name="l00106"></a><a class="code" href="classGENERAL.html#aae4f89d46ccd2d6253d9d07cc62b849b">00106</a> <a class="code" href="classGENERAL.html#aae4f89d46ccd2d6253d9d07cc62b849b">GENERAL::GENERAL</a>(<a class="code" href="classXML_1_1Block.html">XML::Block</a>&amp; X) {
<a name="l00107"></a>00107 
<a name="l00108"></a>00108   <a class="code" href="dla__alg_8h.html#a54194e8aa7ff1f8bb7079bcbf617d359">NHTYPE</a> = 0;
<a name="l00109"></a>00109   <a class="code" href="dla__alg_8h.html#a52b41a08e36114fbb78f5d900f0371b9">NXMAX</a> = 0;
<a name="l00110"></a>00110 
<a name="l00111"></a>00111   <a class="code" href="classGENERAL.html#ab41a179bb7208ea52fd49e567b24ba29">comment</a> = X[<span class="stringliteral">&quot;Comment&quot;</span>].<a class="code" href="classXML_1_1Block.html#a6417a64c12cd4298a11851d6d20b56dd">getJoinedString</a>();
<a name="l00112"></a>00112   <a class="code" href="dla__alg_8h.html#a2dad84a8985d20913d523848ae5e40ea">NSTYPE</a> = X[<span class="stringliteral">&quot;NSTYPE&quot;</span>].<a class="code" href="classXML_1_1Block.html#afcd6370972fce7a0d9378c778f5f09c7">getInteger</a>();
<a name="l00113"></a>00113   <a class="code" href="dla__alg_8h.html#a28e1a55e45e45a80a49a8ae1f0e50bcb">NITYPE</a> = X[<span class="stringliteral">&quot;NITYPE&quot;</span>].<a class="code" href="classXML_1_1Block.html#afcd6370972fce7a0d9378c778f5f09c7">getInteger</a>();
<a name="l00114"></a>00114   <a class="code" href="dla__alg_8h.html#a52b41a08e36114fbb78f5d900f0371b9">NXMAX</a>  = X[<span class="stringliteral">&quot;NXMAX&quot;</span> ].<a class="code" href="classXML_1_1Block.html#afcd6370972fce7a0d9378c778f5f09c7">getInteger</a>();
<a name="l00115"></a>00115   <a class="code" href="dla__alg_8h.html#ab6af66382562de2aa8b45b81e256d909">NVTYPE</a> = <a class="code" href="dla__alg_8h.html#a2dad84a8985d20913d523848ae5e40ea">NSTYPE</a> + <a class="code" href="dla__alg_8h.html#a28e1a55e45e45a80a49a8ae1f0e50bcb">NITYPE</a>;
<a name="l00116"></a>00116 
<a name="l00117"></a>00117 }
<a name="l00118"></a>00118 
<a name="l00119"></a>00119 <span class="comment">//======================================================================</span>
<a name="l00120"></a>00120 
<a name="l00121"></a><a class="code" href="classGENERAL.html#aac759501cf6c7895a70eecbef0226ae1">00121</a> <span class="keywordtype">void</span> <a class="code" href="classGENERAL.html#aac759501cf6c7895a70eecbef0226ae1">GENERAL::write</a>() {
<a name="l00122"></a>00122   fprintf( <a class="code" href="dla__alg_8h.html#a58060d07f59ce3eff252924cf18e5d39">FALG</a>, <span class="stringliteral">&quot;\n&quot;</span>);
<a name="l00123"></a>00123   fprintf( <a class="code" href="dla__alg_8h.html#a58060d07f59ce3eff252924cf18e5d39">FALG</a>, <span class="stringliteral">&quot;  &lt;Comment&gt;\n&quot;</span>);
<a name="l00124"></a>00124   fprintf( <a class="code" href="dla__alg_8h.html#a58060d07f59ce3eff252924cf18e5d39">FALG</a>, <span class="stringliteral">&quot;    %s\n&quot;</span>, <a class="code" href="classGENERAL.html#ab41a179bb7208ea52fd49e567b24ba29">comment</a>.c_str() );
<a name="l00125"></a>00125   fprintf( <a class="code" href="dla__alg_8h.html#a58060d07f59ce3eff252924cf18e5d39">FALG</a>, <span class="stringliteral">&quot;  &lt;/Comment&gt;\n&quot;</span>);
<a name="l00126"></a>00126   fprintf( <a class="code" href="dla__alg_8h.html#a58060d07f59ce3eff252924cf18e5d39">FALG</a>, <span class="stringliteral">&quot;\n&quot;</span>);
<a name="l00127"></a>00127   fprintf( <a class="code" href="dla__alg_8h.html#a58060d07f59ce3eff252924cf18e5d39">FALG</a>, <span class="stringliteral">&quot;  &lt;General&gt;\n&quot;</span>);
<a name="l00128"></a>00128   fprintf( <a class="code" href="dla__alg_8h.html#a58060d07f59ce3eff252924cf18e5d39">FALG</a>, <span class="stringliteral">&quot;    &lt;NSTYPE&gt; %2d &lt;/NSTYPE&gt;\n&quot;</span>, <a class="code" href="dla__alg_8h.html#a2dad84a8985d20913d523848ae5e40ea">NSTYPE</a>);
<a name="l00129"></a>00129   fprintf( <a class="code" href="dla__alg_8h.html#a58060d07f59ce3eff252924cf18e5d39">FALG</a>, <span class="stringliteral">&quot;    &lt;NITYPE&gt; %2d &lt;/NITYPE&gt;\n&quot;</span>, <a class="code" href="dla__alg_8h.html#a28e1a55e45e45a80a49a8ae1f0e50bcb">NITYPE</a>);
<a name="l00130"></a>00130   fprintf( <a class="code" href="dla__alg_8h.html#a58060d07f59ce3eff252924cf18e5d39">FALG</a>, <span class="stringliteral">&quot;    &lt;NVTYPE&gt; %2d &lt;/NVTYPE&gt;\n&quot;</span>, <a class="code" href="dla__alg_8h.html#ab6af66382562de2aa8b45b81e256d909">NVTYPE</a>);
<a name="l00131"></a>00131   fprintf( <a class="code" href="dla__alg_8h.html#a58060d07f59ce3eff252924cf18e5d39">FALG</a>, <span class="stringliteral">&quot;    &lt;NXMAX&gt;  %2d &lt;/NXMAX&gt;\n&quot;</span>,  <a class="code" href="dla__alg_8h.html#a52b41a08e36114fbb78f5d900f0371b9">NXMAX</a> );
<a name="l00132"></a>00132   fprintf( <a class="code" href="dla__alg_8h.html#a58060d07f59ce3eff252924cf18e5d39">FALG</a>, <span class="stringliteral">&quot;    &lt;WDIAG&gt;  %24.16f &lt;/WDIAG&gt;\n&quot;</span>,  <a class="code" href="classGENERAL.html#a7c8080b243082b92783a87fc337edbda">WeightDiagonal</a> );
<a name="l00133"></a>00133   fprintf( <a class="code" href="dla__alg_8h.html#a58060d07f59ce3eff252924cf18e5d39">FALG</a>, <span class="stringliteral">&quot;  &lt;/General&gt;\n&quot;</span>);
<a name="l00134"></a>00134 }
<a name="l00135"></a>00135 
<a name="l00136"></a>00136 <span class="comment">//######################################################################</span>
<a name="l00137"></a>00137 
<a name="l00138"></a><a class="code" href="classSITE.html#af8b2b5aa28e95ab6c30d43fd63cb4723">00138</a> <span class="keywordtype">void</span> <a class="code" href="classSITE.html#af8b2b5aa28e95ab6c30d43fd63cb4723">SITE::load</a>(<a class="code" href="classXML_1_1Block.html">XML::Block</a>&amp; X) {
<a name="l00139"></a>00139   <a class="code" href="classSITE.html#af180e926633cde08a05ccbc3af397ee4">ID</a>    = X[<span class="stringliteral">&quot;STYPE&quot;</span>].<a class="code" href="classXML_1_1Block.html#afcd6370972fce7a0d9378c778f5f09c7">getInteger</a>();
<a name="l00140"></a>00140   <a class="code" href="classSITE.html#a5e8d338d9f4e30c0b0a52ee8b76982ec">TTYPE</a> = X[<span class="stringliteral">&quot;TTYPE&quot;</span>].<a class="code" href="classXML_1_1Block.html#afcd6370972fce7a0d9378c778f5f09c7">getInteger</a>();
<a name="l00141"></a>00141   <a class="code" href="classSITE.html#ab304b26016ce886af898dfdaed93a120">NX</a>    = X[<span class="stringliteral">&quot;NX&quot;</span>].<a class="code" href="classXML_1_1Block.html#afcd6370972fce7a0d9378c778f5f09c7">getInteger</a>();
<a name="l00142"></a>00142   <a class="code" href="classSITE.html#af745eddec2b559b752f0c911f7d4a257">_T</a> = &amp;<a class="code" href="dla__alg_8h.html#a35f116b5f6905f314bc3858998e27dd2">Source</a>[<a class="code" href="classSITE.html#a5e8d338d9f4e30c0b0a52ee8b76982ec">TTYPE</a>];
<a name="l00143"></a>00143 }
<a name="l00144"></a>00144 
<a name="l00145"></a>00145 <span class="comment">//======================================================================</span>
<a name="l00146"></a>00146 
<a name="l00147"></a><a class="code" href="classSITE.html#a195e3bfbedc4c32872c153629fc7d74b">00147</a> <span class="keywordtype">void</span> <a class="code" href="classSITE.html#a195e3bfbedc4c32872c153629fc7d74b">SITE::SetInitialHeadTypeProbability</a>() {
<a name="l00148"></a>00148   <a class="code" href="classSITE.html#adb97fc436189a73c3fde020301a62af2">VTYPE</a> = <a class="code" href="dla__alg_8h.html#a35f116b5f6905f314bc3858998e27dd2">Source</a>[<a class="code" href="classSITE.html#a5e8d338d9f4e30c0b0a52ee8b76982ec">TTYPE</a>].<a class="code" href="classSOURCE.html#adb97fc436189a73c3fde020301a62af2">VTYPE</a>;
<a name="l00149"></a>00149 <span class="comment">// WormCreationNewState( xi, ch)  </span>
<a name="l00150"></a>00150 <span class="comment">// &quot;xi&quot;. .. the initial local state</span>
<a name="l00151"></a>00151 <span class="comment">// &quot;ch&quot; ... the scattering channel id</span>
<a name="l00152"></a>00152   <a class="code" href="classSITE.html#a818a8ecf8164e6c66a32e67a0443b473">WormCreationNewState</a>.<a class="code" href="classArray.html#a5fd83b4910658540977272a168cfbdae">init</a>(2,<a class="code" href="dla__alg_8h.html#a52b41a08e36114fbb78f5d900f0371b9">NXMAX</a>,2*<a class="code" href="dla__alg_8h.html#a52b41a08e36114fbb78f5d900f0371b9">NXMAX</a>); 
<a name="l00153"></a>00153   <a class="code" href="classSITE.html#a818a8ecf8164e6c66a32e67a0443b473">WormCreationNewState</a>.<a class="code" href="classArray.html#a46c36a9a7be294d4f647798d07c79c7e">set_all</a>(<a class="code" href="namespaceSTATE.html#a6af3477d2e74163c155b0d0a2e4265ae">STATE::UNDEF</a>);
<a name="l00154"></a>00154   <a class="code" href="classSITE.html#a1a09d02b02dc5735d5afd6d9dd909b4f">WormCreationDirection</a>.<a class="code" href="classArray.html#a5fd83b4910658540977272a168cfbdae">init</a>(2,<a class="code" href="dla__alg_8h.html#a52b41a08e36114fbb78f5d900f0371b9">NXMAX</a>,2*<a class="code" href="dla__alg_8h.html#a52b41a08e36114fbb78f5d900f0371b9">NXMAX</a>);
<a name="l00155"></a>00155   <a class="code" href="classSITE.html#a1a09d02b02dc5735d5afd6d9dd909b4f">WormCreationDirection</a>.<a class="code" href="classArray.html#a46c36a9a7be294d4f647798d07c79c7e">set_all</a>(<a class="code" href="namespaceDIR.html#a6af3477d2e74163c155b0d0a2e4265ae">DIR::UNDEF</a>);
<a name="l00156"></a>00156   <a class="code" href="classSITE.html#a05e2e55547b3c3aec0362999dd18f4f3">WormCreationProbability</a>.<a class="code" href="classArray.html#a5fd83b4910658540977272a168cfbdae">init</a>(2,<a class="code" href="dla__alg_8h.html#a52b41a08e36114fbb78f5d900f0371b9">NXMAX</a>,2*<a class="code" href="dla__alg_8h.html#a52b41a08e36114fbb78f5d900f0371b9">NXMAX</a>);
<a name="l00157"></a>00157   <a class="code" href="classSITE.html#a05e2e55547b3c3aec0362999dd18f4f3">WormCreationProbability</a>.<a class="code" href="classArray.html#a46c36a9a7be294d4f647798d07c79c7e">set_all</a>(0.0);
<a name="l00158"></a>00158   <a class="code" href="classSITE.html#a1bd21fb7a8f293844612156e0b9a0c9e">NumberOfChannels</a> = <span class="keyword">new</span> <span class="keywordtype">int</span>[<a class="code" href="classSITE.html#ab304b26016ce886af898dfdaed93a120">NX</a>];
<a name="l00159"></a>00159   <a class="code" href="classVERTEX.html">VERTEX</a>&amp; <a class="code" href="classSITE.html#acf0575128e042bee98addaa5135a21ab">V</a> = <a class="code" href="classVertex.html">Vertex</a>[<a class="code" href="classSITE.html#adb97fc436189a73c3fde020301a62af2">VTYPE</a>];
<a name="l00160"></a>00160   <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> i=0; i&lt;V.<a class="code" href="classVERTEX.html#a1f75a9744b8c73b83a83c3e3924f3811">NICG</a>; i++ ) {
<a name="l00161"></a>00161     <a class="code" href="classInitialConfigurationGroup.html">InitialConfigurationGroup</a>&amp; icg = V.<a class="code" href="classVERTEX.html#a5bf3f6148e8638d310911312eedb314a">ICG</a>(i);
<a name="l00162"></a>00162     <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> j=0; j&lt;icg.<a class="code" href="classInitialConfigurationGroup.html#ac2ef20a53da6bbd710051417ccf102a6">NIC</a>; j++ ) {
<a name="l00163"></a>00163       <a class="code" href="classInitialConfiguration.html">InitialConfiguration</a>&amp; ic = icg.<a class="code" href="classInitialConfigurationGroup.html#a3fab21a5c15ed8b5668a2cc3bf6c575d">IC</a>[j];
<a name="l00164"></a>00164       <span class="keywordflow">if</span> ( ic.<a class="code" href="classInitialConfiguration.html#a66e9afc35cfde27c7f2c650df188c0c8">INC</a> == <a class="code" href="namespaceDIR.html#a6af3477d2e74163c155b0d0a2e4265ae">DIR::UNDEF</a> ) {
<a name="l00165"></a>00165         <span class="keywordtype">int</span> x0 = ic.<a class="code" href="classInitialConfiguration.html#a1b922b6523bd302b3a36812b23c4eebb">State</a>[0];
<a name="l00166"></a>00166         <span class="keywordtype">int</span> NCH = ic.<a class="code" href="classInitialConfiguration.html#abec7c8ef75bc4b811f2eb3d4e8db6d2b">NCH</a>;
<a name="l00167"></a>00167         <a class="code" href="classSITE.html#a1bd21fb7a8f293844612156e0b9a0c9e">NumberOfChannels</a>[x0] = NCH;
<a name="l00168"></a>00168         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> c=0; c&lt;NCH; c++) {
<a name="l00169"></a>00169           <span class="keywordtype">int</span> st = ic.<a class="code" href="classInitialConfiguration.html#a228ef943ea00843456f11a742a1426aa">FinalState</a>[c];
<a name="l00170"></a>00170           <span class="keywordtype">int</span> out = ic.<a class="code" href="classInitialConfiguration.html#af60991908d4085d9b1282624853d053e">FinalDirection</a>[c];
<a name="l00171"></a>00171           <span class="keywordtype">double</span> p = ic.<a class="code" href="classInitialConfiguration.html#ab861732a67ffb9d9c9cc061b0d77faae">ScatteringProbability</a>[c];
<a name="l00172"></a>00172           <a class="code" href="classSITE.html#a818a8ecf8164e6c66a32e67a0443b473">WormCreationNewState</a>(x0,c) = st;
<a name="l00173"></a>00173           <a class="code" href="classSITE.html#a1a09d02b02dc5735d5afd6d9dd909b4f">WormCreationDirection</a>(x0,c) = out;
<a name="l00174"></a>00174           <a class="code" href="classSITE.html#a05e2e55547b3c3aec0362999dd18f4f3">WormCreationProbability</a>(x0,c) = p;
<a name="l00175"></a>00175         }
<a name="l00176"></a>00176       }
<a name="l00177"></a>00177     }
<a name="l00178"></a>00178   }
<a name="l00179"></a>00179 }
<a name="l00180"></a>00180 
<a name="l00181"></a>00181 <span class="comment">//======================================================================</span>
<a name="l00182"></a>00182 
<a name="l00183"></a><a class="code" href="classSITE.html#aac759501cf6c7895a70eecbef0226ae1">00183</a> <span class="keywordtype">void</span> <a class="code" href="classSITE.html#aac759501cf6c7895a70eecbef0226ae1">SITE::write</a>() {
<a name="l00184"></a>00184   fprintf(<a class="code" href="dla__alg_8h.html#a58060d07f59ce3eff252924cf18e5d39">FALG</a>,<span class="stringliteral">&quot;\n&quot;</span>);
<a name="l00185"></a>00185   fprintf(<a class="code" href="dla__alg_8h.html#a58060d07f59ce3eff252924cf18e5d39">FALG</a>,<span class="stringliteral">&quot;  &lt;Site&gt;\n&quot;</span>);
<a name="l00186"></a>00186   fprintf(<a class="code" href="dla__alg_8h.html#a58060d07f59ce3eff252924cf18e5d39">FALG</a>,<span class="stringliteral">&quot;    &lt;STYPE&gt; %d &lt;/STYPE&gt;\n&quot;</span>, <a class="code" href="classSITE.html#af180e926633cde08a05ccbc3af397ee4">ID</a>);
<a name="l00187"></a>00187   fprintf(<a class="code" href="dla__alg_8h.html#a58060d07f59ce3eff252924cf18e5d39">FALG</a>,<span class="stringliteral">&quot;    &lt;NumberOfStates&gt; %d &lt;/NumberOfStates&gt;\n&quot;</span>, <a class="code" href="classSITE.html#ab304b26016ce886af898dfdaed93a120">NX</a>);
<a name="l00188"></a>00188   fprintf(<a class="code" href="dla__alg_8h.html#a58060d07f59ce3eff252924cf18e5d39">FALG</a>,<span class="stringliteral">&quot;    &lt;VertexTypeOfSource&gt; %d &lt;/VertexTypeOfSource&gt;\n&quot;</span>, <a class="code" href="classSITE.html#adb97fc436189a73c3fde020301a62af2">VTYPE</a>);
<a name="l00189"></a>00189   <span class="comment">//printf(&quot;    &lt;EBASE&gt; %24.16f &lt;/EBASE&gt;\n&quot;, V().EBASE );</span>
<a name="l00190"></a>00190   <span class="comment">//fprintf(FALG,&quot;    &lt;EBASE&gt; %24.16f &lt;/EBASE&gt;\n&quot;, V().EBASE );</span>
<a name="l00191"></a>00191   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> x0=0; x0&lt;<a class="code" href="classSITE.html#ab304b26016ce886af898dfdaed93a120">NX</a>; x0++) {
<a name="l00192"></a>00192     fprintf(<a class="code" href="dla__alg_8h.html#a58060d07f59ce3eff252924cf18e5d39">FALG</a>,<span class="stringliteral">&quot;    &lt;InitialConfiguration&gt;\n&quot;</span>);
<a name="l00193"></a>00193     fprintf(<a class="code" href="dla__alg_8h.html#a58060d07f59ce3eff252924cf18e5d39">FALG</a>,<span class="stringliteral">&quot;      &lt;State&gt; %d &lt;/State&gt;\n&quot;</span>, x0);
<a name="l00194"></a>00194     <span class="keywordtype">int</span> NCH = <a class="code" href="classSITE.html#a1bd21fb7a8f293844612156e0b9a0c9e">NumberOfChannels</a>[x0];
<a name="l00195"></a>00195     fprintf(<a class="code" href="dla__alg_8h.html#a58060d07f59ce3eff252924cf18e5d39">FALG</a>,<span class="stringliteral">&quot;      &lt;NumberOfChannels&gt; %d &lt;/NumberOfChannels&gt;\n&quot;</span>, NCH);
<a name="l00196"></a>00196     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> c=0; c&lt;NCH; c++) {
<a name="l00197"></a>00197       <span class="keywordtype">int</span> diri = <a class="code" href="classSITE.html#a1a09d02b02dc5735d5afd6d9dd909b4f">WormCreationDirection</a>( x0, c);
<a name="l00198"></a>00198       <span class="keywordtype">int</span> xnew = <a class="code" href="classSITE.html#a818a8ecf8164e6c66a32e67a0443b473">WormCreationNewState</a>( x0, c);
<a name="l00199"></a>00199       <span class="keywordtype">double</span> p = <a class="code" href="classSITE.html#a05e2e55547b3c3aec0362999dd18f4f3">WormCreationProbability</a>( x0, c);
<a name="l00200"></a>00200       <span class="keywordflow">if</span> ( p == 0.0 ) <span class="keywordflow">continue</span>;
<a name="l00201"></a>00201       fprintf(<a class="code" href="dla__alg_8h.html#a58060d07f59ce3eff252924cf18e5d39">FALG</a>,<span class="stringliteral">&quot;      &lt;Channel&gt; %4d %4d %24.16f &lt;/Channel&gt;\n&quot;</span>, diri, xnew, p );
<a name="l00202"></a>00202     }
<a name="l00203"></a>00203     fprintf(<a class="code" href="dla__alg_8h.html#a58060d07f59ce3eff252924cf18e5d39">FALG</a>,<span class="stringliteral">&quot;    &lt;/InitialConfiguration&gt;\n&quot;</span>);
<a name="l00204"></a>00204   }
<a name="l00205"></a>00205   fprintf(<a class="code" href="dla__alg_8h.html#a58060d07f59ce3eff252924cf18e5d39">FALG</a>,<span class="stringliteral">&quot;  &lt;/Site&gt;\n&quot;</span>);
<a name="l00206"></a>00206 }
<a name="l00207"></a>00207 
<a name="l00208"></a>00208 <span class="comment">//======================================================================</span>
<a name="l00209"></a>00209 
<a name="l00210"></a><a class="code" href="classSITE.html#accd2600060dbaee3a3b41aed4034c63c">00210</a> <span class="keywordtype">void</span> <a class="code" href="classSITE.html#accd2600060dbaee3a3b41aed4034c63c">SITE::dump</a>() {
<a name="l00211"></a>00211   printf(<span class="stringliteral">&quot;\n&quot;</span>);
<a name="l00212"></a>00212   printf(<span class="stringliteral">&quot;SITE[%d]&gt; tt=%2d, NX=%2d\n&quot;</span>, <a class="code" href="classSITE.html#af180e926633cde08a05ccbc3af397ee4">ID</a>, <a class="code" href="classSITE.html#a5e8d338d9f4e30c0b0a52ee8b76982ec">TTYPE</a>, <a class="code" href="classSITE.html#ab304b26016ce886af898dfdaed93a120">NX</a>);
<a name="l00213"></a>00213   <span class="keywordflow">if</span> ( <a class="code" href="classSITE.html#a1bd21fb7a8f293844612156e0b9a0c9e">NumberOfChannels</a> == 0 ) {
<a name="l00214"></a>00214     printf(<span class="stringliteral">&quot; ... Channels have not been defined yet.\n&quot;</span>);
<a name="l00215"></a>00215   } <span class="keywordflow">else</span> {
<a name="l00216"></a>00216     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> x=0; x&lt;<a class="code" href="classSITE.html#ab304b26016ce886af898dfdaed93a120">NX</a>; x++) {
<a name="l00217"></a>00217       printf(<span class="stringliteral">&quot;  x=%2d : &quot;</span>, x);
<a name="l00218"></a>00218       <span class="keywordtype">int</span> NCH = <a class="code" href="classSITE.html#a1bd21fb7a8f293844612156e0b9a0c9e">NumberOfChannels</a>[x];
<a name="l00219"></a>00219       printf(<span class="stringliteral">&quot;  NCH= %d\n&quot;</span>, NCH);
<a name="l00220"></a>00220       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> c=0; c&lt;NCH; c++) {
<a name="l00221"></a>00221         printf(<span class="stringliteral">&quot;   %2d %2d %8.3f\n&quot;</span>, 
<a name="l00222"></a>00222           <a class="code" href="classSITE.html#a1a09d02b02dc5735d5afd6d9dd909b4f">WormCreationDirection</a>(x,c), 
<a name="l00223"></a>00223           <a class="code" href="classSITE.html#a818a8ecf8164e6c66a32e67a0443b473">WormCreationNewState</a>(x,c), 
<a name="l00224"></a>00224           <a class="code" href="classSITE.html#a05e2e55547b3c3aec0362999dd18f4f3">WormCreationProbability</a>(x,c));
<a name="l00225"></a>00225       }
<a name="l00226"></a>00226     }
<a name="l00227"></a>00227   }
<a name="l00228"></a>00228 }
<a name="l00229"></a>00229 
<a name="l00230"></a>00230 <span class="comment">//######################################################################</span>
<a name="l00231"></a>00231 
<a name="l00232"></a><a class="code" href="classSOURCE.html#af8b2b5aa28e95ab6c30d43fd63cb4723">00232</a> <span class="keywordtype">void</span> <a class="code" href="classSOURCE.html#af8b2b5aa28e95ab6c30d43fd63cb4723">SOURCE::load</a>(<a class="code" href="classXML_1_1Block.html">XML::Block</a>&amp; X) {
<a name="l00233"></a>00233   <a class="code" href="classSOURCE.html#af180e926633cde08a05ccbc3af397ee4">ID</a>    = X[<span class="stringliteral">&quot;TTYPE&quot;</span>].<a class="code" href="classXML_1_1Block.html#afcd6370972fce7a0d9378c778f5f09c7">getInteger</a>();
<a name="l00234"></a>00234   <a class="code" href="classSOURCE.html#adb97fc436189a73c3fde020301a62af2">VTYPE</a> = <a class="code" href="classSOURCE.html#af180e926633cde08a05ccbc3af397ee4">ID</a>;
<a name="l00235"></a>00235   <a class="code" href="classVERTEX.html">VERTEX</a>&amp; <a class="code" href="classSOURCE.html#a075af34a843191d8a1dc1cb9db262c8b">V</a> = <a class="code" href="classVertex.html">Vertex</a>[<a class="code" href="classSOURCE.html#adb97fc436189a73c3fde020301a62af2">VTYPE</a>];
<a name="l00236"></a>00236   <a class="code" href="classSOURCE.html#a0a50d02fe67a9a6dead68e688c51942c">_V</a> = &amp;<a class="code" href="classSOURCE.html#a075af34a843191d8a1dc1cb9db262c8b">V</a>;
<a name="l00237"></a>00237   V.<a class="code" href="classVERTEX.html#af180e926633cde08a05ccbc3af397ee4">ID</a> = <a class="code" href="classSOURCE.html#adb97fc436189a73c3fde020301a62af2">VTYPE</a>;
<a name="l00238"></a>00238   V.<a class="code" href="classVERTEX.html#a40b6cb423d67e694bd442231902c4b06">NBODY</a> = 1;
<a name="l00239"></a>00239   V.<a class="code" href="classVERTEX.html#a643f76773b1f3f1446cc4b24aa3e0ad3">CATEGORY</a> = <a class="code" href="namespaceVCAT.html#a61263646e7c804385f85f85cfe19a16d">VCAT::WORM</a>;
<a name="l00240"></a>00240   V.<a class="code" href="classVERTEX.html#af8b2b5aa28e95ab6c30d43fd63cb4723">load</a>(X);
<a name="l00241"></a>00241 }
<a name="l00242"></a>00242 
<a name="l00243"></a>00243 <span class="comment">//======================================================================</span>
<a name="l00244"></a>00244 
<a name="l00245"></a><a class="code" href="classSOURCE.html#accd2600060dbaee3a3b41aed4034c63c">00245</a> <span class="keywordtype">void</span> <a class="code" href="classSOURCE.html#accd2600060dbaee3a3b41aed4034c63c">SOURCE::dump</a>() {
<a name="l00246"></a>00246   printf(<span class="stringliteral">&quot;SOURCE[%d]&gt; vt=%2d\n&quot;</span>, <a class="code" href="classSOURCE.html#af180e926633cde08a05ccbc3af397ee4">ID</a>, <a class="code" href="classSOURCE.html#adb97fc436189a73c3fde020301a62af2">VTYPE</a>);
<a name="l00247"></a>00247 }
<a name="l00248"></a>00248 
<a name="l00249"></a>00249 <span class="comment">//######################################################################</span>
<a name="l00250"></a>00250 
<a name="l00251"></a><a class="code" href="classINTERACTION.html#af8b2b5aa28e95ab6c30d43fd63cb4723">00251</a> <span class="keywordtype">void</span> <a class="code" href="classINTERACTION.html#af8b2b5aa28e95ab6c30d43fd63cb4723">INTERACTION::load</a>(<a class="code" href="classXML_1_1Block.html">XML::Block</a>&amp; X) {
<a name="l00252"></a>00252   <a class="code" href="classINTERACTION.html#af180e926633cde08a05ccbc3af397ee4">ID</a>    = X[<span class="stringliteral">&quot;ITYPE&quot;</span>].<a class="code" href="classXML_1_1Block.html#afcd6370972fce7a0d9378c778f5f09c7">getInteger</a>();
<a name="l00253"></a>00253   <a class="code" href="classINTERACTION.html#adb97fc436189a73c3fde020301a62af2">VTYPE</a> = <a class="code" href="classINTERACTION.html#af180e926633cde08a05ccbc3af397ee4">ID</a> + <a class="code" href="dla__alg_8h.html#a2dad84a8985d20913d523848ae5e40ea">NSTYPE</a>;
<a name="l00254"></a>00254   <a class="code" href="classINTERACTION.html#a0a50d02fe67a9a6dead68e688c51942c">_V</a> = &amp;(<a class="code" href="classVertex.html">Vertex</a>[<a class="code" href="classINTERACTION.html#adb97fc436189a73c3fde020301a62af2">VTYPE</a>]);
<a name="l00255"></a>00255   <a class="code" href="classINTERACTION.html#a40b6cb423d67e694bd442231902c4b06">NBODY</a> = X[<span class="stringliteral">&quot;NBODY&quot;</span>].<a class="code" href="classXML_1_1Block.html#afcd6370972fce7a0d9378c778f5f09c7">getInteger</a>();
<a name="l00256"></a>00256   <a class="code" href="classINTERACTION.html#a075af34a843191d8a1dc1cb9db262c8b">V</a>().<a class="code" href="classVERTEX.html#af180e926633cde08a05ccbc3af397ee4">ID</a> = <a class="code" href="classINTERACTION.html#adb97fc436189a73c3fde020301a62af2">VTYPE</a>;
<a name="l00257"></a>00257   <a class="code" href="classINTERACTION.html#a075af34a843191d8a1dc1cb9db262c8b">V</a>().<a class="code" href="classVERTEX.html#a40b6cb423d67e694bd442231902c4b06">NBODY</a> = <a class="code" href="classINTERACTION.html#a40b6cb423d67e694bd442231902c4b06">NBODY</a>;
<a name="l00258"></a>00258   <a class="code" href="classINTERACTION.html#a075af34a843191d8a1dc1cb9db262c8b">V</a>().<a class="code" href="classVERTEX.html#a643f76773b1f3f1446cc4b24aa3e0ad3">CATEGORY</a> = <a class="code" href="namespaceVCAT.html#aad63d4da4983eace804e391db3539c73">VCAT::INT</a>;
<a name="l00259"></a>00259   <a class="code" href="classINTERACTION.html#a075af34a843191d8a1dc1cb9db262c8b">V</a>().<a class="code" href="classVERTEX.html#af8b2b5aa28e95ab6c30d43fd63cb4723">load</a>(X);
<a name="l00260"></a>00260 }
<a name="l00261"></a>00261 
<a name="l00262"></a>00262 <span class="comment">//======================================================================</span>
<a name="l00263"></a>00263 
<a name="l00264"></a><a class="code" href="classINTERACTION.html#aba4a1294bfe9d3836105eb940e41387f">00264</a> <span class="keywordtype">void</span> <a class="code" href="classINTERACTION.html#aba4a1294bfe9d3836105eb940e41387f">INTERACTION::SetVertexDensity</a>() {
<a name="l00265"></a>00265   <a class="code" href="classVERTEX.html">VERTEX</a>&amp; <a class="code" href="classINTERACTION.html#a075af34a843191d8a1dc1cb9db262c8b">V</a> = <a class="code" href="classVertex.html">Vertex</a>[<a class="code" href="classINTERACTION.html#adb97fc436189a73c3fde020301a62af2">VTYPE</a>];
<a name="l00266"></a>00266   <a class="code" href="classIndexSystem.html">IndexSystem</a>&amp; I = V.<a class="code" href="classVERTEX.html#af56e280b2c94cebef5c80e6707062b18">Weight</a>.<a class="code" href="classArray.html#af3eb8ccfdf7db40cd0777ba00b810577">index_system</a>();
<a name="l00267"></a>00267   <span class="keywordtype">int</span>* x = <span class="keyword">new</span> <span class="keywordtype">int</span>[I.<a class="code" href="classIndexSystem.html#abe81a2fadde630519c7abc1d05c463cf">dimension</a>()]; <span class="comment">//edit sakakura</span>
<a name="l00268"></a>00268 <span class="comment">//  int x[I.dimension()];</span>
<a name="l00269"></a>00269   <a class="code" href="classINTERACTION.html#a02f62c9684ac7a21d53a738c6dfea2d6">VertexDensity</a>.<a class="code" href="classArray.html#a5fd83b4910658540977272a168cfbdae">init</a>( <a class="code" href="classINTERACTION.html#a40b6cb423d67e694bd442231902c4b06">NBODY</a> , <a class="code" href="dla__alg_8h.html#a52b41a08e36114fbb78f5d900f0371b9">NXMAX</a> , <a class="code" href="namespaceARRAY.html#a4379c573b2795966768cefb17743590a">ARRAY::EOL</a> );
<a name="l00270"></a>00270   <a class="code" href="classIndexSystem.html">IndexSystem</a>&amp; J = <a class="code" href="classINTERACTION.html#a02f62c9684ac7a21d53a738c6dfea2d6">VertexDensity</a>.<a class="code" href="classArray.html#af3eb8ccfdf7db40cd0777ba00b810577">index_system</a>();
<a name="l00271"></a>00271 <span class="comment">//  int y[J.dimension()];</span>
<a name="l00272"></a>00272   <span class="keywordtype">int</span>* y = <span class="keyword">new</span> <span class="keywordtype">int</span>[J.<a class="code" href="classIndexSystem.html#abe81a2fadde630519c7abc1d05c463cf">dimension</a>()]; <span class="comment">//edit sakakura</span>
<a name="l00273"></a>00273   <a class="code" href="classINTERACTION.html#a02f62c9684ac7a21d53a738c6dfea2d6">VertexDensity</a>.<a class="code" href="classArray.html#a46c36a9a7be294d4f647798d07c79c7e">set_all</a>(0.0);
<a name="l00274"></a>00274   <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> g=0; g&lt;V.<a class="code" href="classVERTEX.html#a1f75a9744b8c73b83a83c3e3924f3811">NICG</a>; g++ ) {
<a name="l00275"></a>00275     <a class="code" href="classInitialConfigurationGroup.html">InitialConfigurationGroup</a>&amp; G = V.<a class="code" href="classVERTEX.html#a5bf3f6148e8638d310911312eedb314a">ICG</a>(g);
<a name="l00276"></a>00276     <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> c=0; c&lt;G.<a class="code" href="classInitialConfigurationGroup.html#ac2ef20a53da6bbd710051417ccf102a6">NIC</a>; c++ ) {
<a name="l00277"></a>00277       <a class="code" href="classInitialConfiguration.html">InitialConfiguration</a>&amp; C = G.<a class="code" href="classInitialConfigurationGroup.html#a3fab21a5c15ed8b5668a2cc3bf6c575d">IC</a>[c];
<a name="l00278"></a>00278       <span class="keywordflow">if</span> ( ! C.<a class="code" href="classInitialConfiguration.html#a0757ddb5fa3cf27ba383415646971d13">isKink</a>() ) {
<a name="l00279"></a>00279         <span class="keywordtype">int</span> sti = C.<a class="code" href="classInitialConfiguration.html#a92297bc6de760f10ff2e8f4e25ecac0b">STI</a>;
<a name="l00280"></a>00280         <span class="keywordtype">double</span> w = C.<a class="code" href="classInitialConfiguration.html#af8629ff71647bc503d20d9141e4da152">vertex_weight</a>();
<a name="l00281"></a>00281         I.<a class="code" href="classIndexSystem.html#a4f12ec2efb69b48e312e4ef7c400492c">coord</a>(sti,x);
<a name="l00282"></a>00282         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classINTERACTION.html#a40b6cb423d67e694bd442231902c4b06">NBODY</a>; i++) y[i] = x[2*i];
<a name="l00283"></a>00283         <a class="code" href="classINTERACTION.html#a02f62c9684ac7a21d53a738c6dfea2d6">VertexDensity</a>(y) = w;
<a name="l00284"></a>00284       }
<a name="l00285"></a>00285     }
<a name="l00286"></a>00286   }
<a name="l00287"></a>00287   <span class="keyword">delete</span> []x;
<a name="l00288"></a>00288   <span class="keyword">delete</span> []y;
<a name="l00289"></a>00289 }
<a name="l00290"></a>00290 
<a name="l00291"></a>00291 <span class="comment">//======================================================================</span>
<a name="l00292"></a>00292 
<a name="l00293"></a><a class="code" href="classINTERACTION.html#aac759501cf6c7895a70eecbef0226ae1">00293</a> <span class="keywordtype">void</span> <a class="code" href="classINTERACTION.html#aac759501cf6c7895a70eecbef0226ae1">INTERACTION::write</a>() {
<a name="l00294"></a>00294   fprintf(<a class="code" href="dla__alg_8h.html#a58060d07f59ce3eff252924cf18e5d39">FALG</a>,<span class="stringliteral">&quot;\n&quot;</span>);
<a name="l00295"></a>00295   fprintf(<a class="code" href="dla__alg_8h.html#a58060d07f59ce3eff252924cf18e5d39">FALG</a>,<span class="stringliteral">&quot;  &lt;Interaction&gt;\n&quot;</span>);
<a name="l00296"></a>00296   fprintf(<a class="code" href="dla__alg_8h.html#a58060d07f59ce3eff252924cf18e5d39">FALG</a>,<span class="stringliteral">&quot;    &lt;ITYPE&gt; %d &lt;/ITYPE&gt;\n&quot;</span>, <a class="code" href="classINTERACTION.html#af180e926633cde08a05ccbc3af397ee4">ID</a>);
<a name="l00297"></a>00297   fprintf(<a class="code" href="dla__alg_8h.html#a58060d07f59ce3eff252924cf18e5d39">FALG</a>,<span class="stringliteral">&quot;    &lt;VTYPE&gt; %d &lt;/VTYPE&gt;\n&quot;</span>, <a class="code" href="classINTERACTION.html#adb97fc436189a73c3fde020301a62af2">VTYPE</a>);
<a name="l00298"></a>00298   fprintf(<a class="code" href="dla__alg_8h.html#a58060d07f59ce3eff252924cf18e5d39">FALG</a>,<span class="stringliteral">&quot;    &lt;NBODY&gt; %d &lt;/NBODY&gt;\n&quot;</span>, <a class="code" href="classINTERACTION.html#a40b6cb423d67e694bd442231902c4b06">NBODY</a>);
<a name="l00299"></a>00299   fprintf(<a class="code" href="dla__alg_8h.html#a58060d07f59ce3eff252924cf18e5d39">FALG</a>,<span class="stringliteral">&quot;    &lt;EBASE&gt; %24.16f &lt;/EBASE&gt;\n&quot;</span>, <a class="code" href="classINTERACTION.html#a075af34a843191d8a1dc1cb9db262c8b">V</a>().EBASE );
<a name="l00300"></a>00300   <span class="keywordflow">if</span> ( <a class="code" href="classINTERACTION.html#a02f62c9684ac7a21d53a738c6dfea2d6">VertexDensity</a>.<a class="code" href="classArray.html#ae017ed3e4402ecd80fa6e86f10575574">isDefined</a>() ) {
<a name="l00301"></a>00301     <a class="code" href="classIndexSystem.html">IndexSystem</a>&amp; I = <a class="code" href="classINTERACTION.html#a02f62c9684ac7a21d53a738c6dfea2d6">VertexDensity</a>.<a class="code" href="classArray.html#af3eb8ccfdf7db40cd0777ba00b810577">index_system</a>();
<a name="l00302"></a>00302 <span class="comment">//    int x[NBODY];</span>
<a name="l00303"></a>00303     <span class="keywordtype">int</span>* x = <span class="keyword">new</span> <span class="keywordtype">int</span>[<a class="code" href="classINTERACTION.html#a40b6cb423d67e694bd442231902c4b06">NBODY</a>]; <span class="comment">//edit sakakura</span>
<a name="l00304"></a>00304     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;I.<a class="code" href="classIndexSystem.html#af4b57d21919c42d55af03391f91a1c08">size</a>(); i++) {
<a name="l00305"></a>00305       <span class="keywordtype">double</span> d = <a class="code" href="classINTERACTION.html#a02f62c9684ac7a21d53a738c6dfea2d6">VertexDensity</a>[i];
<a name="l00306"></a>00306       <span class="keywordflow">if</span> ( d &gt; 0.0 ) {
<a name="l00307"></a>00307         I.<a class="code" href="classIndexSystem.html#a4f12ec2efb69b48e312e4ef7c400492c">coord</a>( i, x);
<a name="l00308"></a>00308         fprintf(<a class="code" href="dla__alg_8h.html#a58060d07f59ce3eff252924cf18e5d39">FALG</a>,<span class="stringliteral">&quot;    &lt;VertexDensity&gt; &quot;</span>);
<a name="l00309"></a>00309         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;<a class="code" href="classINTERACTION.html#a40b6cb423d67e694bd442231902c4b06">NBODY</a>; j++) fprintf(<a class="code" href="dla__alg_8h.html#a58060d07f59ce3eff252924cf18e5d39">FALG</a>,<span class="stringliteral">&quot; %2d&quot;</span>, x[j]);
<a name="l00310"></a>00310         fprintf(<a class="code" href="dla__alg_8h.html#a58060d07f59ce3eff252924cf18e5d39">FALG</a>,<span class="stringliteral">&quot; %24.16f &lt;/VertexDensity&gt;\n&quot;</span>, d);
<a name="l00311"></a>00311       }
<a name="l00312"></a>00312     }
<a name="l00313"></a>00313     <span class="keyword">delete</span> []x;
<a name="l00314"></a>00314   } <span class="keywordflow">else</span> {
<a name="l00315"></a>00315 <span class="comment">//  fprintf(FALG,&quot;  VertexDensity is not defined.\n&quot;);</span>
<a name="l00316"></a>00316   }
<a name="l00317"></a>00317   fprintf(<a class="code" href="dla__alg_8h.html#a58060d07f59ce3eff252924cf18e5d39">FALG</a>,<span class="stringliteral">&quot;  &lt;/Interaction&gt;\n&quot;</span>);
<a name="l00318"></a>00318 }
<a name="l00319"></a>00319 
<a name="l00320"></a>00320 <span class="comment">//======================================================================</span>
<a name="l00321"></a>00321 
<a name="l00322"></a><a class="code" href="classINTERACTION.html#accd2600060dbaee3a3b41aed4034c63c">00322</a> <span class="keywordtype">void</span> <a class="code" href="classINTERACTION.html#accd2600060dbaee3a3b41aed4034c63c">INTERACTION::dump</a>() {
<a name="l00323"></a>00323   printf(<span class="stringliteral">&quot;INTERACTION[%d] &quot;</span>, <a class="code" href="classINTERACTION.html#af180e926633cde08a05ccbc3af397ee4">ID</a>);
<a name="l00324"></a>00324   printf(<span class="stringliteral">&quot;, vt=%2d&quot;</span>, <a class="code" href="classINTERACTION.html#adb97fc436189a73c3fde020301a62af2">VTYPE</a>);
<a name="l00325"></a>00325   printf(<span class="stringliteral">&quot;, nb=%2d&quot;</span>, <a class="code" href="classINTERACTION.html#a40b6cb423d67e694bd442231902c4b06">NBODY</a>);
<a name="l00326"></a>00326   printf(<span class="stringliteral">&quot;\n&quot;</span>);
<a name="l00327"></a>00327   <span class="keywordflow">if</span> ( <a class="code" href="classINTERACTION.html#a02f62c9684ac7a21d53a738c6dfea2d6">VertexDensity</a>.<a class="code" href="classArray.html#ae017ed3e4402ecd80fa6e86f10575574">isDefined</a>() ) {
<a name="l00328"></a>00328     <a class="code" href="classIndexSystem.html">IndexSystem</a>&amp; I = <a class="code" href="classINTERACTION.html#a02f62c9684ac7a21d53a738c6dfea2d6">VertexDensity</a>.<a class="code" href="classArray.html#af3eb8ccfdf7db40cd0777ba00b810577">index_system</a>();
<a name="l00329"></a>00329 <span class="comment">//    int x[NBODY];</span>
<a name="l00330"></a>00330     <span class="keywordtype">int</span>* x = <span class="keyword">new</span> <span class="keywordtype">int</span>[<a class="code" href="classINTERACTION.html#a40b6cb423d67e694bd442231902c4b06">NBODY</a>]; <span class="comment">//edit sakakura</span>
<a name="l00331"></a>00331     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;I.<a class="code" href="classIndexSystem.html#af4b57d21919c42d55af03391f91a1c08">size</a>(); i++) {
<a name="l00332"></a>00332       <span class="keywordflow">if</span> ( <a class="code" href="classINTERACTION.html#a02f62c9684ac7a21d53a738c6dfea2d6">VertexDensity</a>[i] &gt; 0.0 ) {
<a name="l00333"></a>00333         I.<a class="code" href="classIndexSystem.html#a4f12ec2efb69b48e312e4ef7c400492c">coord</a>( i, x);
<a name="l00334"></a>00334         printf(<span class="stringliteral">&quot; x= (&quot;</span>);
<a name="l00335"></a>00335         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;I.<a class="code" href="classIndexSystem.html#abe81a2fadde630519c7abc1d05c463cf">dimension</a>(); j++) printf(<span class="stringliteral">&quot; %1d&quot;</span>, x[j]);
<a name="l00336"></a>00336         printf(<span class="stringliteral">&quot;)&quot;</span>);
<a name="l00337"></a>00337         printf(<span class="stringliteral">&quot; density= %8.3f\n&quot;</span>, <a class="code" href="classINTERACTION.html#a02f62c9684ac7a21d53a738c6dfea2d6">VertexDensity</a>[i]);
<a name="l00338"></a>00338         printf(<span class="stringliteral">&quot;\n&quot;</span>);
<a name="l00339"></a>00339       }
<a name="l00340"></a>00340     }
<a name="l00341"></a>00341     <span class="keyword">delete</span> []x;
<a name="l00342"></a>00342   } <span class="keywordflow">else</span> {
<a name="l00343"></a>00343     printf(<span class="stringliteral">&quot;  VertexDensity is not defined.\n&quot;</span>);
<a name="l00344"></a>00344   }
<a name="l00345"></a>00345 }
<a name="l00346"></a>00346 
<a name="l00347"></a>00347 <span class="comment">//######################################################################</span>
<a name="l00348"></a>00348 
<a name="l00349"></a><a class="code" href="classVERTEX.html#af8b2b5aa28e95ab6c30d43fd63cb4723">00349</a> <span class="keywordtype">void</span> <a class="code" href="classVERTEX.html#af8b2b5aa28e95ab6c30d43fd63cb4723">VERTEX::load</a>(<a class="code" href="classXML_1_1Block.html">XML::Block</a>&amp; X) {
<a name="l00350"></a>00350   <a class="code" href="classVERTEX.html#ad2e978411f291e4018c6291e9d4a6deb">NLEG</a> = 2 * <a class="code" href="classVERTEX.html#a40b6cb423d67e694bd442231902c4b06">NBODY</a>;
<a name="l00351"></a>00351   <a class="code" href="classVERTEX.html#af56e280b2c94cebef5c80e6707062b18">Weight</a>.<a class="code" href="classArray.html#a5fd83b4910658540977272a168cfbdae">init</a>(<span class="stringliteral">&quot;Weight&quot;</span>,<a class="code" href="classVERTEX.html#ad2e978411f291e4018c6291e9d4a6deb">NLEG</a>,<a class="code" href="dla__alg_8h.html#a52b41a08e36114fbb78f5d900f0371b9">NXMAX</a>,<a class="code" href="namespaceARRAY.html#a4379c573b2795966768cefb17743590a">ARRAY::EOL</a>);
<a name="l00352"></a>00352   <a class="code" href="classVERTEX.html#ad737e867fc59a19cb4ec5fe1f5cc92ae">setINDX</a>(<a class="code" href="classVERTEX.html#af56e280b2c94cebef5c80e6707062b18">Weight</a>.<a class="code" href="classArray.html#af3eb8ccfdf7db40cd0777ba00b810577">index_system</a>());
<a name="l00353"></a>00353   <a class="code" href="classVERTEX.html#af56e280b2c94cebef5c80e6707062b18">Weight</a>.<a class="code" href="classArray.html#a46c36a9a7be294d4f647798d07c79c7e">set_all</a>(0.0);
<a name="l00354"></a>00354   <a class="code" href="classVERTEX.html#adfc7b44a2818d3c7bad6890ae07e4b18">NST</a> = <a class="code" href="classVERTEX.html#af56e280b2c94cebef5c80e6707062b18">Weight</a>.<a class="code" href="classArray.html#af4b57d21919c42d55af03391f91a1c08">size</a>();
<a name="l00355"></a>00355   <a class="code" href="classVERTEX.html#ab880edb46dac897b907057c56e65dfc7">SiteTypeOfLeg</a>.<a class="code" href="classArray.html#a5fd83b4910658540977272a168cfbdae">init</a>(<span class="stringliteral">&quot;STYPE&quot;</span>,1,<a class="code" href="classVERTEX.html#ad2e978411f291e4018c6291e9d4a6deb">NLEG</a>);
<a name="l00356"></a>00356   <a class="code" href="classVERTEX.html#ab880edb46dac897b907057c56e65dfc7">SiteTypeOfLeg</a>.<a class="code" href="classArray.html#a46c36a9a7be294d4f647798d07c79c7e">set_all</a>(<a class="code" href="namespaceSTYPE.html#a6af3477d2e74163c155b0d0a2e4265ae">STYPE::UNDEF</a>);
<a name="l00357"></a>00357   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classVERTEX.html#a40b6cb423d67e694bd442231902c4b06">NBODY</a>; i++) {
<a name="l00358"></a>00358     <span class="keywordtype">int</span> st = X[<span class="stringliteral">&quot;STYPE&quot;</span>].<a class="code" href="classXML_1_1Block.html#afcd6370972fce7a0d9378c778f5f09c7">getInteger</a>(i);
<a name="l00359"></a>00359     <a class="code" href="classVERTEX.html#ab880edb46dac897b907057c56e65dfc7">SiteTypeOfLeg</a>[2*i]   = st;
<a name="l00360"></a>00360     <a class="code" href="classVERTEX.html#ab880edb46dac897b907057c56e65dfc7">SiteTypeOfLeg</a>[2*i+1] = st;
<a name="l00361"></a>00361   }
<a name="l00362"></a>00362   <span class="keywordtype">int</span>*  x = <span class="keyword">new</span> <span class="keywordtype">int</span> [<a class="code" href="classVERTEX.html#ad2e978411f291e4018c6291e9d4a6deb">NLEG</a>];
<a name="l00363"></a>00363   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;X.<a class="code" href="classXML_1_1Block.html#a88796becd473f212deb450ad1a31a893">NumberOfBlocks</a>(); i++) {
<a name="l00364"></a>00364     <a class="code" href="classXML_1_1Block.html">XML::Block</a>&amp; B = X[i];
<a name="l00365"></a>00365     <span class="keyword">const</span> <span class="keywordtype">string</span>&amp; name = B.<a class="code" href="classXML_1_1Block.html#a8cf4db36c9f3123506d73e98c4a93464">getName</a>();
<a name="l00366"></a>00366     <span class="keywordflow">if</span> ( name == <span class="stringliteral">&quot;Weight&quot;</span> ) {
<a name="l00367"></a>00367       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classVERTEX.html#ad2e978411f291e4018c6291e9d4a6deb">NLEG</a>; i++) x[i] = B.<a class="code" href="classXML_1_1Block.html#afcd6370972fce7a0d9378c778f5f09c7">getInteger</a>(i);
<a name="l00368"></a>00368       <a class="code" href="classVERTEX.html#af56e280b2c94cebef5c80e6707062b18">Weight</a>(x) = B.<a class="code" href="classXML_1_1Block.html#a0bf14d82466b0e2b1ebff36333d0ad25">getDouble</a>(NLEG);
<a name="l00369"></a>00369     }
<a name="l00370"></a>00370   }
<a name="l00371"></a>00371   <a class="code" href="classVERTEX.html#ad5f4f052b92013a850af5f9ea527d8b5">EBASE</a> = 0.0;
<a name="l00372"></a>00372   <span class="keyword">delete</span> [] x;
<a name="l00373"></a>00373 }
<a name="l00374"></a>00374 
<a name="l00375"></a>00375 <span class="comment">//======================================================================</span>
<a name="l00376"></a>00376 
<a name="l00377"></a><a class="code" href="classVERTEX.html#a61a8b33c0a1a82d50982964b857c20cc">00377</a> <span class="keywordtype">int</span> <a class="code" href="classVERTEX.html#a61a8b33c0a1a82d50982964b857c20cc">VERTEX::NumberOfValidInitialConfigurations</a>() {
<a name="l00378"></a>00378   <span class="keywordtype">int</span> c = 0;
<a name="l00379"></a>00379   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classVERTEX.html#a1f75a9744b8c73b83a83c3e3924f3811">NICG</a>; i++) {
<a name="l00380"></a>00380     <span class="keywordtype">int</span> n = <a class="code" href="classVERTEX.html#a5bf3f6148e8638d310911312eedb314a">ICG</a>(i).<a class="code" href="classInitialConfigurationGroup.html#a61a8b33c0a1a82d50982964b857c20cc">NumberOfValidInitialConfigurations</a>();
<a name="l00381"></a>00381     c += n;
<a name="l00382"></a>00382   }
<a name="l00383"></a>00383   <span class="keywordflow">return</span> c;
<a name="l00384"></a>00384 }
<a name="l00385"></a>00385 
<a name="l00386"></a>00386 <span class="comment">//======================================================================</span>
<a name="l00387"></a>00387 
<a name="l00388"></a><a class="code" href="classVERTEX.html#ab97c868b9eb83616652ff0552d24ccd8">00388</a> <span class="keywordtype">void</span> <a class="code" href="classVERTEX.html#ab97c868b9eb83616652ff0552d24ccd8">VERTEX::Grouping</a>() {
<a name="l00389"></a>00389 
<a name="l00390"></a>00390 <span class="comment">//printf(&quot;VERTEX::Grouping&gt; Start ID=%d\n&quot;, ID);</span>
<a name="l00391"></a>00391 <span class="comment">//printf(&quot;VERTEX::Grouping&gt; Start.\n&quot;);</span>
<a name="l00392"></a>00392 <span class="comment">//printf(&quot;VERTEX::Grouping&gt; Pass 1\n&quot;);</span>
<a name="l00393"></a>00393 
<a name="l00394"></a>00394   <span class="keywordtype">int</span> NICmax = 2 * <a class="code" href="classVERTEX.html#a40b6cb423d67e694bd442231902c4b06">NBODY</a> * <a class="code" href="dla__alg_8h.html#a52b41a08e36114fbb78f5d900f0371b9">NXMAX</a> + 1;
<a name="l00395"></a>00395 <span class="comment">//ICG.init( 1, (NST+1)*NXMAX ); // ëÂÇ´ÇﬂÇ…Ç∆Ç¡ÇƒÇ†ÇÈÅD</span>
<a name="l00396"></a>00396   <a class="code" href="classVERTEX.html#a722d16497db8771d93b3dc55c9729fef">checked</a>.<a class="code" href="classArray.html#a5fd83b4910658540977272a168cfbdae">init</a>( 3, <a class="code" href="classVERTEX.html#adfc7b44a2818d3c7bad6890ae07e4b18">NST</a>, <a class="code" href="classVERTEX.html#ad2e978411f291e4018c6291e9d4a6deb">NLEG</a> , NXMAX );
<a name="l00397"></a>00397   <a class="code" href="classVERTEX.html#a722d16497db8771d93b3dc55c9729fef">checked</a>.<a class="code" href="classArray.html#a46c36a9a7be294d4f647798d07c79c7e">set_all</a>(0);
<a name="l00398"></a>00398   <span class="keywordtype">int</span>* x = <span class="keyword">new</span> <span class="keywordtype">int</span>[<a class="code" href="classVERTEX.html#ad2e978411f291e4018c6291e9d4a6deb">NLEG</a>];
<a name="l00399"></a>00399 <span class="comment">//  int x[NLEG];</span>
<a name="l00400"></a>00400   <a class="code" href="classVERTEX.html#a1f75a9744b8c73b83a83c3e3924f3811">NICG</a> = 0;
<a name="l00401"></a>00401   <span class="keywordflow">if</span> ( <a class="code" href="classVERTEX.html#abc6a960d3033961b012d05681773110c">isWorm</a>() ) {
<a name="l00402"></a>00402     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> sti=0; sti&lt;<a class="code" href="classVERTEX.html#adfc7b44a2818d3c7bad6890ae07e4b18">NST</a>; sti++) {
<a name="l00403"></a>00403       <span class="keywordflow">if</span> ( <a class="code" href="classVERTEX.html#aa6f285b73f7bfee462f5227d73db8ddb">testForbidden</a>(sti) ) <span class="keywordflow">continue</span>;
<a name="l00404"></a>00404       <span class="keywordflow">if</span> ( <a class="code" href="classVERTEX.html#a4d2943bb66a9923a6da9b065ca64984a">testKink</a>(sti) ) <span class="keywordflow">continue</span>;
<a name="l00405"></a>00405       <span class="keywordtype">int</span> inc = <a class="code" href="namespaceSTYPE.html#a6af3477d2e74163c155b0d0a2e4265ae">DIR::UNDEF</a>;
<a name="l00406"></a>00406       <span class="keywordtype">int</span> xinc = <a class="code" href="namespaceSTYPE.html#a6af3477d2e74163c155b0d0a2e4265ae">STATE::UNDEF</a>;
<a name="l00407"></a>00407       <a class="code" href="classInitialConfigurationGroup.html">InitialConfigurationGroup</a>&amp; <a class="code" href="classVERTEX.html#ad3d4699a589cebfac09661cb5f211a73">icg</a> = *(<span class="keyword">new</span> <a class="code" href="classInitialConfigurationGroup.html">InitialConfigurationGroup</a>);
<a name="l00408"></a>00408       icg.<a class="code" href="classInitialConfigurationGroup.html#ad2792a3d2bcb1db2d0aaffff1234715e">init</a>(*<span class="keyword">this</span>, <a class="code" href="classVERTEX.html#a40b6cb423d67e694bd442231902c4b06">NBODY</a> , sti, inc, xinc);
<a name="l00409"></a>00409       <a class="code" href="classVERTEX.html#ac7f892e270e883aa7db9c3abdb8d8f55">add_ICG</a>( icg );
<a name="l00410"></a>00410 <span class="comment">//printf(&quot;VERTEX::Grouping&gt; New initial configuration group. ID= %d\n&quot;, NICG);</span>
<a name="l00411"></a>00411       <a class="code" href="classVERTEX.html#a1f75a9744b8c73b83a83c3e3924f3811">NICG</a>++;
<a name="l00412"></a>00412     }
<a name="l00413"></a>00413   } <span class="keywordflow">else</span> {
<a name="l00414"></a>00414 
<a name="l00415"></a>00415     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> sti=0; sti&lt;<a class="code" href="classVERTEX.html#adfc7b44a2818d3c7bad6890ae07e4b18">NST</a>; sti++) {
<a name="l00416"></a>00416       <a class="code" href="classVERTEX.html#af0261ee9ed4d08c911429c30fba45bae">INDX</a>().<a class="code" href="classIndexSystem.html#a4f12ec2efb69b48e312e4ef7c400492c">coord</a>(sti,x);
<a name="l00417"></a>00417       <span class="keywordflow">if</span> ( <a class="code" href="classVERTEX.html#aa6f285b73f7bfee462f5227d73db8ddb">testForbidden</a>(sti) ) <span class="keywordflow">continue</span>;
<a name="l00418"></a>00418       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> inc=0; inc&lt;<a class="code" href="classVERTEX.html#ad2e978411f291e4018c6291e9d4a6deb">NLEG</a>; inc++) {
<a name="l00419"></a>00419         <span class="keywordtype">int</span> xinc_old = x[inc];
<a name="l00420"></a>00420         <span class="keywordtype">int</span> st = <a class="code" href="classVERTEX.html#ab880edb46dac897b907057c56e65dfc7">SiteTypeOfLeg</a>[inc];
<a name="l00421"></a>00421         <a class="code" href="classSOURCE.html">SOURCE</a>&amp; W = <a class="code" href="dla__alg_8h.html#a35f116b5f6905f314bc3858998e27dd2">Source</a>[<a class="code" href="classSite.html">Site</a>[st].TTYPE];
<a name="l00422"></a>00422         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> xinc=0; xinc&lt;<a class="code" href="dla__alg_8h.html#a52b41a08e36114fbb78f5d900f0371b9">NXMAX</a>; xinc++) {
<a name="l00423"></a>00423 <span class="comment">//W.V().Weight.index_system().dump();</span>
<a name="l00424"></a>00424           <span class="keywordtype">double</span> ww = W.<a class="code" href="classSOURCE.html#a9ba355badb4b5f534c7c29bd049d4358">Weight</a>( xinc_old , xinc );
<a name="l00425"></a>00425           <span class="comment">/*</span>
<a name="l00426"></a>00426 <span class="comment">printf(&quot; sti= %d =(&quot;, sti);</span>
<a name="l00427"></a>00427 <span class="comment">for (int i=0; i&lt;NLEG; i++) printf(&quot; %d&quot;, x[i]);</span>
<a name="l00428"></a>00428 <span class="comment">printf(&quot;), inc= %d, xinc= %d --&gt; %d, ww= %8.3f\n&quot;, inc, xinc_old, xinc, ww);</span>
<a name="l00429"></a>00429 <span class="comment">          */</span>
<a name="l00430"></a>00430           <span class="keywordflow">if</span> ( ww == 0.0 ) <span class="keywordflow">continue</span>;
<a name="l00431"></a>00431           <span class="keywordflow">if</span> ( <a class="code" href="classVERTEX.html#a722d16497db8771d93b3dc55c9729fef">checked</a>( sti, inc , xinc) == 1 ) <span class="keywordflow">continue</span>;
<a name="l00432"></a>00432 
<a name="l00433"></a>00433 <span class="comment">//printf(&quot;VERTEX::Grouping&gt; New initial configuration group. ID= %d\n&quot;, NICG);</span>
<a name="l00434"></a>00434           <a class="code" href="classInitialConfigurationGroup.html">InitialConfigurationGroup</a>&amp; <a class="code" href="classVERTEX.html#ad3d4699a589cebfac09661cb5f211a73">icg</a> = *(<span class="keyword">new</span> <a class="code" href="classInitialConfigurationGroup.html">InitialConfigurationGroup</a>);
<a name="l00435"></a>00435           icg.<a class="code" href="classInitialConfigurationGroup.html#ad2792a3d2bcb1db2d0aaffff1234715e">init</a>( *<span class="keyword">this</span>, <a class="code" href="classVERTEX.html#a40b6cb423d67e694bd442231902c4b06">NBODY</a>, sti, inc, xinc);
<a name="l00436"></a>00436           <a class="code" href="classVERTEX.html#ac7f892e270e883aa7db9c3abdb8d8f55">add_ICG</a>( icg );
<a name="l00437"></a>00437           <a class="code" href="classVERTEX.html#a1f75a9744b8c73b83a83c3e3924f3811">NICG</a>++;
<a name="l00438"></a>00438         }
<a name="l00439"></a>00439       }
<a name="l00440"></a>00440     }
<a name="l00441"></a>00441 <span class="comment">//printf(&quot; NICG= %d, icg.size()= %d\n&quot;, NICG, icg.size());</span>
<a name="l00442"></a>00442   }
<a name="l00443"></a>00443   <span class="keyword">delete</span> []x;
<a name="l00444"></a>00444 }
<a name="l00445"></a>00445 
<a name="l00446"></a>00446 <span class="comment">//======================================================================</span>
<a name="l00447"></a>00447 
<a name="l00448"></a><a class="code" href="classVERTEX.html#aa6f8348a028e6d508a0d2571119d0463">00448</a> <span class="keywordtype">double</span> <a class="code" href="classVERTEX.html#aa6f8348a028e6d508a0d2571119d0463">VERTEX::ComputeEBASE</a>() {
<a name="l00449"></a>00449 
<a name="l00450"></a>00450 <span class="comment">// Ç±Ç±Ç≈åvéZÇ∑ÇÈ EBASE ÇÕîÒëŒäpèÛë‘Ç≈ÇÃÉoÉEÉìÉXämó¶Ç™ÇO</span>
<a name="l00451"></a>00451 <span class="comment">// Ç∆Ç»ÇÈÇΩÇﬂÇÃïKóvÇ»îΩì]ÉnÉ~ÉãÉgÉjÉAÉìÅi = -H ÅjÇ÷ÇÃ</span>
<a name="l00452"></a>00452 <span class="comment">// ïtâ¡çÄÇÃç≈è¨ílÇ≈Ç†ÇÈÅDíºê⁄ÉVÉ~ÉÖÉåÅ[ÉgÇ≥ÇÍÇÈ</span>
<a name="l00453"></a>00453 <span class="comment">// ÉyÉAÉnÉ~ÉãÉgÉjÉAÉìÇ H&#39; Ç∆Ç∑ÇÈÇ∆ -H&#39; = -H + ebase </span>
<a name="l00454"></a>00454 <span class="comment">// Ç≈Ç†ÇÈÇ©ÇÁÅCH = H&#39; + ebase Ç∆Ç»ÇËÅC</span>
<a name="l00455"></a>00455 <span class="comment">// åvéZå„Ç…ÇPinteraction Ç†ÇΩÇËÅC EBASE ÇëSÉGÉlÉãÉMÅ[Ç…</span>
<a name="l00456"></a>00456 <span class="comment">// ë´ÇµñﬂÇ∑Ç±Ç∆Ç≈Ç‡Ç∆ÇÃÉnÉ~ÉãÉgÉjÉAÉìÇ≈</span>
<a name="l00457"></a>00457 <span class="comment">// åvéZÇµÇΩÉGÉlÉãÉMÅ[Ç™ìæÇÁÇÍÇÈÅD</span>
<a name="l00458"></a>00458 <span class="comment">//</span>
<a name="l00459"></a>00459 <span class="comment">// EBASE ÇÃÇ∆ÇËï˚ÇÕîCà”ê´Ç™Ç†ÇÈÇ™ÅCÇ∆ÇËï˚Ç…ÇÊÇ¡ÇƒÅC</span>
<a name="l00460"></a>00460 <span class="comment">// ÉoÉEÉìÉXÇ™î≠ê∂ÇµÇΩÇËÇµÇ»Ç©ÇΩÇËÇ∑ÇÈÅDÇ±Ç±Ç≈ÇÃÉ|ÉäÉVÅ[ÇÕÅC</span>
<a name="l00461"></a>00461 <span class="comment">//</span>
<a name="l00462"></a>00462 <span class="comment">// Å@ÅiÇPÅjÉèÅ[ÉÄê∂ê¨ÅCè¡ñ≈Ç…ä÷ÇµÇƒÇÕÅCÇΩÇ∆Ç¶ëŒäpÉoÉEÉìÉX</span>
<a name="l00463"></a>00463 <span class="comment">// Å@Å@Å@Å@Ç™î≠ê∂ÇµÇƒÇ‡ÅCîÒëŒäpèÛë‘ä‘ÇÃíºê⁄ëJà⁄ÇÇ≥ÇØÇÈÅD</span>
<a name="l00464"></a>00464 <span class="comment">// Å@Å@Å@Å@Ç¬Ç‹ÇËÅCEBASE ÇïKóvÇ»ÇæÇØëÂÇ´Ç≠Ç∆Ç¡ÇƒÅC</span>
<a name="l00465"></a>00465 <span class="comment">//         ÉèÅ[ÉÄê∂ê¨ämó¶Ç™ÇPÇÊÇËè¨Ç≥Ç≠Ç»Ç¡ÇƒÇ‡ÅCè¡ñ≈ÇÕ</span>
<a name="l00466"></a>00466 <span class="comment">//         ämó¶ÇPÇ≈ãNÇ´ÇÈÇÊÇ§Ç…Ç∑ÇÈÅD</span>
<a name="l00467"></a>00467 <span class="comment">// Å@ÅiÇQÅjí èÌÇÃëäå›çÏópÉoÅ[ÉeÉbÉNÉXÇ…Ç¬Ç¢ÇƒÇÕÅCîÒëŒäp</span>
<a name="l00468"></a>00468 <span class="comment">// Å@Å@Å@Å@ÉoÉEÉìÉXÇ™Ç»Ç¢îÕàÕÇ≈ëŒäpèdÇ›Çç≈è¨Ç…Ç∆ÇÈÅD</span>
<a name="l00469"></a>00469 <span class="comment">//</span>
<a name="l00470"></a>00470 <span class="comment">// Ç≈Ç†ÇÈÅD</span>
<a name="l00471"></a>00471 
<a name="l00472"></a>00472   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="classVERTEX.html#ad3d4699a589cebfac09661cb5f211a73">icg</a>=0; <a class="code" href="classVERTEX.html#ad3d4699a589cebfac09661cb5f211a73">icg</a>&lt;<a class="code" href="classVERTEX.html#a1f75a9744b8c73b83a83c3e3924f3811">NICG</a>; <a class="code" href="classVERTEX.html#ad3d4699a589cebfac09661cb5f211a73">icg</a>++) <a class="code" href="classVERTEX.html#a5bf3f6148e8638d310911312eedb314a">ICG</a>(<a class="code" href="classVERTEX.html#ad3d4699a589cebfac09661cb5f211a73">icg</a>).<a class="code" href="classInitialConfigurationGroup.html#ae0c5fed98c4283eb8d16f8e08a2e2dda">ResetWeight</a>();
<a name="l00473"></a>00473 
<a name="l00474"></a>00474   <span class="keywordtype">double</span> eb;
<a name="l00475"></a>00475   <span class="keywordflow">if</span>        ( <a class="code" href="classVERTEX.html#a643f76773b1f3f1446cc4b24aa3e0ad3">CATEGORY</a> == <a class="code" href="namespaceVCAT.html#a0a5dba6a1474034dbc50e8de3560f059">VCAT::TERM</a> ) {
<a name="l00476"></a>00476     eb = 1.0;
<a name="l00477"></a>00477   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <a class="code" href="classVERTEX.html#a643f76773b1f3f1446cc4b24aa3e0ad3">CATEGORY</a> == <a class="code" href="namespaceVCAT.html#a61263646e7c804385f85f85cfe19a16d">VCAT::WORM</a> ) {
<a name="l00478"></a>00478     eb = -<a class="code" href="name_8h.html#a12c2040f25d8e3a7b9e1c2024c618cb6">INF</a>;
<a name="l00479"></a>00479     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="classVERTEX.html#ad3d4699a589cebfac09661cb5f211a73">icg</a>=0; <a class="code" href="classVERTEX.html#ad3d4699a589cebfac09661cb5f211a73">icg</a>&lt;<a class="code" href="classVERTEX.html#a1f75a9744b8c73b83a83c3e3924f3811">NICG</a>; <a class="code" href="classVERTEX.html#ad3d4699a589cebfac09661cb5f211a73">icg</a>++) {
<a name="l00480"></a>00480       <span class="keywordtype">double</span> e = <a class="code" href="classVERTEX.html#a5bf3f6148e8638d310911312eedb314a">ICG</a>(<a class="code" href="classVERTEX.html#ad3d4699a589cebfac09661cb5f211a73">icg</a>).<a class="code" href="classInitialConfigurationGroup.html#a8d59b14bde1d74067ca8d8c92dfbea42">sum_of_all_weights</a>();
<a name="l00481"></a>00481       <span class="keywordflow">if</span> ( eb &lt; e ) eb = e;
<a name="l00482"></a>00482     }
<a name="l00483"></a>00483   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <a class="code" href="classVERTEX.html#a643f76773b1f3f1446cc4b24aa3e0ad3">CATEGORY</a> == <a class="code" href="namespaceVCAT.html#aad63d4da4983eace804e391db3539c73">VCAT::INT</a> ) {
<a name="l00484"></a>00484     eb = -<a class="code" href="name_8h.html#a12c2040f25d8e3a7b9e1c2024c618cb6">INF</a>;
<a name="l00485"></a>00485     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="classVERTEX.html#ad3d4699a589cebfac09661cb5f211a73">icg</a>=0; <a class="code" href="classVERTEX.html#ad3d4699a589cebfac09661cb5f211a73">icg</a>&lt;<a class="code" href="classVERTEX.html#a1f75a9744b8c73b83a83c3e3924f3811">NICG</a>; <a class="code" href="classVERTEX.html#ad3d4699a589cebfac09661cb5f211a73">icg</a>++) {
<a name="l00486"></a>00486       <span class="keywordtype">double</span> e = <a class="code" href="classVERTEX.html#a5bf3f6148e8638d310911312eedb314a">ICG</a>(<a class="code" href="classVERTEX.html#ad3d4699a589cebfac09661cb5f211a73">icg</a>).<a class="code" href="classInitialConfigurationGroup.html#acb2fe234ee5fb671be3e252f7326ef83">ebase</a>();
<a name="l00487"></a>00487       <span class="keywordflow">if</span> ( eb &lt; e ) eb = e;
<a name="l00488"></a>00488     }
<a name="l00489"></a>00489   } <span class="keywordflow">else</span> { printf(<span class="stringliteral">&quot;VERTEX::ComputeEBASE&gt; Error.\n&quot;</span>); exit(0); }
<a name="l00490"></a>00490   <span class="keywordflow">return</span> eb;
<a name="l00491"></a>00491 
<a name="l00492"></a>00492 }
<a name="l00493"></a>00493 
<a name="l00494"></a>00494 <span class="comment">//======================================================================</span>
<a name="l00495"></a>00495 
<a name="l00496"></a><a class="code" href="classVERTEX.html#aac173812b616dcf98703adad3c42ee5e">00496</a> <span class="keywordtype">void</span> <a class="code" href="classVERTEX.html#aac173812b616dcf98703adad3c42ee5e">VERTEX::ComputeScatteringProbability</a>() {
<a name="l00497"></a>00497 
<a name="l00498"></a>00498 <span class="comment">//printf(&quot;\nVERTEX::ComputeScatteringProbability&gt; Start.\n&quot;);</span>
<a name="l00499"></a>00499   <a class="code" href="classVERTEX.html#a3f028327ee96edfd6f3bf4bcfd3f9546">NICV</a> = 0;
<a name="l00500"></a>00500   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="classVERTEX.html#ad3d4699a589cebfac09661cb5f211a73">icg</a>=0; <a class="code" href="classVERTEX.html#ad3d4699a589cebfac09661cb5f211a73">icg</a>&lt;<a class="code" href="classVERTEX.html#a1f75a9744b8c73b83a83c3e3924f3811">NICG</a>; <a class="code" href="classVERTEX.html#ad3d4699a589cebfac09661cb5f211a73">icg</a>++) {
<a name="l00501"></a>00501     <a class="code" href="classVERTEX.html#a5bf3f6148e8638d310911312eedb314a">ICG</a>(<a class="code" href="classVERTEX.html#ad3d4699a589cebfac09661cb5f211a73">icg</a>).<a class="code" href="classInitialConfigurationGroup.html#ae0c5fed98c4283eb8d16f8e08a2e2dda">ResetWeight</a>();
<a name="l00502"></a>00502     <a class="code" href="classVERTEX.html#a5bf3f6148e8638d310911312eedb314a">ICG</a>(<a class="code" href="classVERTEX.html#ad3d4699a589cebfac09661cb5f211a73">icg</a>).<a class="code" href="classInitialConfigurationGroup.html#a7c48614b600846f95d9e65681bfe8588">numbering</a>(<a class="code" href="classVERTEX.html#a3f028327ee96edfd6f3bf4bcfd3f9546">NICV</a>);
<a name="l00503"></a>00503     <a class="code" href="classVERTEX.html#a5bf3f6148e8638d310911312eedb314a">ICG</a>(<a class="code" href="classVERTEX.html#ad3d4699a589cebfac09661cb5f211a73">icg</a>).<a class="code" href="classInitialConfigurationGroup.html#a21991132691d4646e8ab528a6354612f">ScatteringProbability</a>();
<a name="l00504"></a>00504   }
<a name="l00505"></a>00505 <span class="comment">//printf(&quot;\nVERTEX::ComputeScatteringProbability&gt; End.\n&quot;);</span>
<a name="l00506"></a>00506 
<a name="l00507"></a>00507 }
<a name="l00508"></a>00508 
<a name="l00509"></a>00509 <span class="comment">//======================================================================</span>
<a name="l00510"></a>00510 
<a name="l00511"></a><a class="code" href="classVERTEX.html#accd2600060dbaee3a3b41aed4034c63c">00511</a> <span class="keywordtype">void</span> <a class="code" href="classVERTEX.html#accd2600060dbaee3a3b41aed4034c63c">VERTEX::dump</a>() {
<a name="l00512"></a>00512   printf(<span class="stringliteral">&quot;VERTEX[%d] cat= %d&quot;</span>, <a class="code" href="classVERTEX.html#af180e926633cde08a05ccbc3af397ee4">ID</a>, <a class="code" href="classVERTEX.html#a643f76773b1f3f1446cc4b24aa3e0ad3">CATEGORY</a>);
<a name="l00513"></a>00513   printf(<span class="stringliteral">&quot; nb= %d&quot;</span>, <a class="code" href="classVERTEX.html#a40b6cb423d67e694bd442231902c4b06">NBODY</a>);
<a name="l00514"></a>00514   printf(<span class="stringliteral">&quot; nl= %d&quot;</span>, <a class="code" href="classVERTEX.html#ad2e978411f291e4018c6291e9d4a6deb">NLEG</a>);
<a name="l00515"></a>00515   printf(<span class="stringliteral">&quot; ncig= %d&quot;</span>, <a class="code" href="classVERTEX.html#a1f75a9744b8c73b83a83c3e3924f3811">NICG</a>);
<a name="l00516"></a>00516   printf(<span class="stringliteral">&quot; eb= %8.3f&quot;</span>, <a class="code" href="classVERTEX.html#ad5f4f052b92013a850af5f9ea527d8b5">EBASE</a>);
<a name="l00517"></a>00517   printf(<span class="stringliteral">&quot; st= (&quot;</span>);
<a name="l00518"></a>00518   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classVERTEX.html#ad2e978411f291e4018c6291e9d4a6deb">NLEG</a>; i++) printf(<span class="stringliteral">&quot; %1d&quot;</span>, <a class="code" href="classVERTEX.html#ab880edb46dac897b907057c56e65dfc7">SiteTypeOfLeg</a>(i));
<a name="l00519"></a>00519   printf(<span class="stringliteral">&quot;)\n&quot;</span>);
<a name="l00520"></a>00520   <span class="keywordtype">int</span>* x = <span class="keyword">new</span> <span class="keywordtype">int</span>[<a class="code" href="classVERTEX.html#ad2e978411f291e4018c6291e9d4a6deb">NLEG</a>]; <span class="comment">//edit sakakura</span>
<a name="l00521"></a>00521 <span class="comment">//  int x[NLEG];</span>
<a name="l00522"></a>00522   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classVERTEX.html#adfc7b44a2818d3c7bad6890ae07e4b18">NST</a>; i++) {
<a name="l00523"></a>00523     <span class="keywordflow">if</span> ( (!<a class="code" href="classVERTEX.html#a4d2943bb66a9923a6da9b065ca64984a">testKink</a>(i)) || <a class="code" href="classVERTEX.html#af56e280b2c94cebef5c80e6707062b18">Weight</a>[i] != 0.0) {
<a name="l00524"></a>00524       <span class="keywordflow">if</span> ( <a class="code" href="classVERTEX.html#a4d2943bb66a9923a6da9b065ca64984a">testKink</a>(i) ) { printf(<span class="stringliteral">&quot; kink:yes &quot;</span>); } <span class="keywordflow">else</span> { printf(<span class="stringliteral">&quot; kink:no  &quot;</span>); }
<a name="l00525"></a>00525       <span class="keywordflow">if</span> ( <a class="code" href="classVERTEX.html#af56e280b2c94cebef5c80e6707062b18">Weight</a>[i] == 0.0 ) { printf(<span class="stringliteral">&quot; w=0:yes &quot;</span>); } <span class="keywordflow">else</span> { printf(<span class="stringliteral">&quot; w=0:no  &quot;</span>); }
<a name="l00526"></a>00526       <a class="code" href="classVERTEX.html#af0261ee9ed4d08c911429c30fba45bae">INDX</a>().<a class="code" href="classIndexSystem.html#a4f12ec2efb69b48e312e4ef7c400492c">coord</a>(i,x);
<a name="l00527"></a>00527       printf(<span class="stringliteral">&quot; (&quot;</span>);
<a name="l00528"></a>00528       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;<a class="code" href="classVERTEX.html#ad2e978411f291e4018c6291e9d4a6deb">NLEG</a>; j++) printf(<span class="stringliteral">&quot; %1d&quot;</span>, x[j]);
<a name="l00529"></a>00529       printf(<span class="stringliteral">&quot;) --&gt; w= %8.3f\n&quot;</span>, <a class="code" href="classVERTEX.html#af56e280b2c94cebef5c80e6707062b18">Weight</a>[i]);
<a name="l00530"></a>00530     }
<a name="l00531"></a>00531   }
<a name="l00532"></a>00532   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classVERTEX.html#a1f75a9744b8c73b83a83c3e3924f3811">NICG</a>; i++) {
<a name="l00533"></a>00533     printf(<span class="stringliteral">&quot;\n&quot;</span>);
<a name="l00534"></a>00534     <a class="code" href="classVERTEX.html#a5bf3f6148e8638d310911312eedb314a">ICG</a>(i).<a class="code" href="classInitialConfigurationGroup.html#accd2600060dbaee3a3b41aed4034c63c">dump</a>();
<a name="l00535"></a>00535   }
<a name="l00536"></a>00536   <span class="keyword">delete</span> []x;
<a name="l00537"></a>00537 }
<a name="l00538"></a>00538 
<a name="l00539"></a>00539 <span class="comment">//======================================================================</span>
<a name="l00540"></a>00540 
<a name="l00541"></a><a class="code" href="classVERTEX.html#aac759501cf6c7895a70eecbef0226ae1">00541</a> <span class="keywordtype">void</span> <a class="code" href="classVERTEX.html#aac759501cf6c7895a70eecbef0226ae1">VERTEX::write</a>() {
<a name="l00542"></a>00542   fprintf(<a class="code" href="dla__alg_8h.html#a58060d07f59ce3eff252924cf18e5d39">FALG</a>,<span class="stringliteral">&quot;\n&quot;</span>);
<a name="l00543"></a>00543   fprintf(<a class="code" href="dla__alg_8h.html#a58060d07f59ce3eff252924cf18e5d39">FALG</a>,<span class="stringliteral">&quot;  &lt;Vertex&gt;\n&quot;</span>);
<a name="l00544"></a>00544   fprintf(<a class="code" href="dla__alg_8h.html#a58060d07f59ce3eff252924cf18e5d39">FALG</a>,<span class="stringliteral">&quot;    &lt;VTYPE&gt; %d &lt;/VTYPE&gt;\n&quot;</span>, <a class="code" href="classVERTEX.html#af180e926633cde08a05ccbc3af397ee4">ID</a>);
<a name="l00545"></a>00545   fprintf(<a class="code" href="dla__alg_8h.html#a58060d07f59ce3eff252924cf18e5d39">FALG</a>,<span class="stringliteral">&quot;    &lt;VCATEGORY&gt; %d &lt;/VCATEGORY&gt;\n&quot;</span>, <a class="code" href="classVERTEX.html#a643f76773b1f3f1446cc4b24aa3e0ad3">CATEGORY</a>);
<a name="l00546"></a>00546   fprintf(<a class="code" href="dla__alg_8h.html#a58060d07f59ce3eff252924cf18e5d39">FALG</a>,<span class="stringliteral">&quot;    &lt;NBODY&gt; %d &lt;/NBODY&gt;\n&quot;</span>, <a class="code" href="classVERTEX.html#a40b6cb423d67e694bd442231902c4b06">NBODY</a>);
<a name="l00547"></a>00547   <span class="keywordtype">int</span> NICW = <a class="code" href="classVERTEX.html#a61a8b33c0a1a82d50982964b857c20cc">NumberOfValidInitialConfigurations</a>();
<a name="l00548"></a>00548   fprintf(<a class="code" href="dla__alg_8h.html#a58060d07f59ce3eff252924cf18e5d39">FALG</a>,<span class="stringliteral">&quot;    &lt;NumberOfInitialConfigurations&gt; %d &lt;/NumberOfInitialConfigurations&gt;\n&quot;</span>, NICW);
<a name="l00549"></a>00549   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classVERTEX.html#a1f75a9744b8c73b83a83c3e3924f3811">NICG</a>; i++) <a class="code" href="classVERTEX.html#a5bf3f6148e8638d310911312eedb314a">ICG</a>(i).<a class="code" href="classInitialConfigurationGroup.html#aac759501cf6c7895a70eecbef0226ae1">write</a>();
<a name="l00550"></a>00550   fprintf(<a class="code" href="dla__alg_8h.html#a58060d07f59ce3eff252924cf18e5d39">FALG</a>,<span class="stringliteral">&quot;\n  &lt;/Vertex&gt;\n&quot;</span>);
<a name="l00551"></a>00551 }
<a name="l00552"></a>00552 
<a name="l00553"></a>00553 <span class="comment">//======================================================================</span>
<a name="l00554"></a>00554 
<a name="l00555"></a><a class="code" href="classVERTEX.html#a4d2943bb66a9923a6da9b065ca64984a">00555</a> <span class="keywordtype">bool</span> <a class="code" href="classVERTEX.html#a4d2943bb66a9923a6da9b065ca64984a">VERTEX::testKink</a>(<span class="keywordtype">int</span> ist) {
<a name="l00556"></a>00556   <span class="comment">//printf(&quot;VERTEX::testKink&gt; D = %d\n&quot;, D);</span>
<a name="l00557"></a>00557   <span class="keywordtype">int</span>* x = <span class="keyword">new</span> <span class="keywordtype">int</span> [<a class="code" href="classVERTEX.html#ad2e978411f291e4018c6291e9d4a6deb">NLEG</a>];
<a name="l00558"></a>00558   <a class="code" href="classVERTEX.html#af0261ee9ed4d08c911429c30fba45bae">INDX</a>().<a class="code" href="classIndexSystem.html#a4f12ec2efb69b48e312e4ef7c400492c">coord</a>(ist,x);
<a name="l00559"></a>00559   <span class="keywordtype">bool</span> ans = <span class="keyword">false</span>;
<a name="l00560"></a>00560   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classVERTEX.html#ad2e978411f291e4018c6291e9d4a6deb">NLEG</a>/2; i++) {
<a name="l00561"></a>00561     <span class="keywordflow">if</span> ( x[2*i] != x[2*i+1] ) ans = <span class="keyword">true</span>;
<a name="l00562"></a>00562   }
<a name="l00563"></a>00563   <span class="keyword">delete</span> [] x;
<a name="l00564"></a>00564   <span class="keywordflow">return</span> ans;
<a name="l00565"></a>00565 }
<a name="l00566"></a>00566 
<a name="l00567"></a>00567 <span class="comment">//======================================================================</span>
<a name="l00568"></a>00568 
<a name="l00569"></a><a class="code" href="classVERTEX.html#aa6f285b73f7bfee462f5227d73db8ddb">00569</a> <span class="keywordtype">bool</span> <a class="code" href="classVERTEX.html#aa6f285b73f7bfee462f5227d73db8ddb">VERTEX::testForbidden</a>(<span class="keywordtype">int</span> ist) {
<a name="l00570"></a>00570   <span class="keywordflow">if</span> ( ! <a class="code" href="classVERTEX.html#a4d2943bb66a9923a6da9b065ca64984a">testKink</a>(ist) ) <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00571"></a>00571   <span class="keywordflow">if</span> ( <a class="code" href="classVERTEX.html#af56e280b2c94cebef5c80e6707062b18">Weight</a>[ist] &gt; 0.0 ) <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00572"></a>00572   <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00573"></a>00573 }
<a name="l00574"></a>00574 
<a name="l00575"></a>00575 <span class="comment">//######################################################################</span>
<a name="l00576"></a>00576 
<a name="l00577"></a><a class="code" href="classInitialConfigurationGroup.html#ad2792a3d2bcb1db2d0aaffff1234715e">00577</a> <span class="keywordtype">void</span> <a class="code" href="classInitialConfigurationGroup.html#ad2792a3d2bcb1db2d0aaffff1234715e">InitialConfigurationGroup::init</a>( 
<a name="l00578"></a>00578   <a class="code" href="classVERTEX.html">VERTEX</a>&amp; v, <span class="keywordtype">int</span> nbody , <span class="keywordtype">int</span> sti, <span class="keywordtype">int</span> inc, <span class="keywordtype">int</span> xinc ) {
<a name="l00579"></a>00579   <span class="comment">// handling a group of initial configurations </span>
<a name="l00580"></a>00580   <span class="comment">// that scatters into each other</span>
<a name="l00581"></a>00581 
<a name="l00582"></a>00582 <span class="comment">//printf(&quot;InitialConfigurationGroup::init&gt; Start. icg=%d\n&quot;, ID);</span>
<a name="l00583"></a>00583 
<a name="l00584"></a>00584   <span class="comment">/*</span>
<a name="l00585"></a>00585 <span class="comment">printf(&quot;nbody= %d, nicmax= %d, sti= %d, inc= %d, xinc= %d\n&quot;,</span>
<a name="l00586"></a>00586 <span class="comment">nbody, NICmax, sti, inc, xinc);</span>
<a name="l00587"></a>00587 <span class="comment">  */</span>
<a name="l00588"></a>00588 
<a name="l00589"></a>00589   <a class="code" href="classInitialConfigurationGroup.html#a0a50d02fe67a9a6dead68e688c51942c">_V</a> = &amp;v;
<a name="l00590"></a>00590   <a class="code" href="classInitialConfigurationGroup.html#a40b6cb423d67e694bd442231902c4b06">NBODY</a> = nbody;
<a name="l00591"></a>00591   <a class="code" href="classInitialConfigurationGroup.html#ad2e978411f291e4018c6291e9d4a6deb">NLEG</a> = 2 * nbody;
<a name="l00592"></a>00592 
<a name="l00593"></a>00593 <span class="comment">//int x[NLEG];</span>
<a name="l00594"></a>00594 <span class="comment">//int y[NLEG];</span>
<a name="l00595"></a>00595   <span class="keywordtype">int</span>* x = <span class="keyword">new</span> <span class="keywordtype">int</span>[<a class="code" href="classInitialConfigurationGroup.html#ad2e978411f291e4018c6291e9d4a6deb">NLEG</a>]; <span class="comment">//edit sakakura</span>
<a name="l00596"></a>00596   <span class="keywordtype">int</span>* y = <span class="keyword">new</span> <span class="keywordtype">int</span>[<a class="code" href="classInitialConfigurationGroup.html#ad2e978411f291e4018c6291e9d4a6deb">NLEG</a>];
<a name="l00597"></a>00597   <a class="code" href="classIndexSystem.html">IndexSystem</a>&amp; INDX = <a class="code" href="classInitialConfigurationGroup.html#a075af34a843191d8a1dc1cb9db262c8b">V</a>().<a class="code" href="classVERTEX.html#af0261ee9ed4d08c911429c30fba45bae">INDX</a>();
<a name="l00598"></a>00598   INDX.<a class="code" href="classIndexSystem.html#a4f12ec2efb69b48e312e4ef7c400492c">coord</a>(sti,x);
<a name="l00599"></a>00599   <span class="keywordflow">if</span> ( inc != <a class="code" href="namespaceDIR.html#a6af3477d2e74163c155b0d0a2e4265ae">DIR::UNDEF</a> ) x[inc] = xinc; 
<a name="l00600"></a>00600   <span class="comment">// x[l] is the local state on the l-th leg </span>
<a name="l00601"></a>00601   <span class="comment">// just after the entrance of the incoming </span>
<a name="l00602"></a>00602   <span class="comment">// worm head (before its outgoing).</span>
<a name="l00603"></a>00603 
<a name="l00604"></a>00604   <span class="comment">/*</span>
<a name="l00605"></a>00605 <span class="comment">if (MON) {</span>
<a name="l00606"></a>00606 <span class="comment">printf(&quot;InitialConfigurationGroup::init&gt; &quot;);</span>
<a name="l00607"></a>00607 <span class="comment">printf(&quot;Grouping the configs related to ... \n&quot;);</span>
<a name="l00608"></a>00608 <span class="comment">printf(&quot;  ...  nb= %d, sti= %d (&quot;, nbody, sti);</span>
<a name="l00609"></a>00609 <span class="comment">for (int i=0; i&lt;NLEG; i++) printf(&quot; %1d&quot;, x[i]);</span>
<a name="l00610"></a>00610 <span class="comment">printf(&quot;), hti= %d, inc= %d\n&quot;, hti, inc);</span>
<a name="l00611"></a>00611 <span class="comment">}</span>
<a name="l00612"></a>00612 <span class="comment">  */</span>
<a name="l00613"></a>00613 
<a name="l00614"></a>00614   <span class="keywordtype">int</span> sitei = inc / 2;
<a name="l00615"></a>00615   <span class="keywordtype">int</span> diri  = inc % 2;
<a name="l00616"></a>00616 
<a name="l00617"></a>00617 <span class="comment">// ç≈èâÇ…ÉOÉãÅ[ÉvÇ…ëÆÇ∑ÇÈèÛë‘êîÇÉJÉEÉìÉgÇ∑ÇÈ</span>
<a name="l00618"></a>00618 
<a name="l00619"></a>00619   <a class="code" href="classInitialConfigurationGroup.html#ac2ef20a53da6bbd710051417ccf102a6">NIC</a>=0;
<a name="l00620"></a>00620   <span class="keywordflow">if</span> ( inc == <a class="code" href="namespaceDIR.html#a6af3477d2e74163c155b0d0a2e4265ae">DIR::UNDEF</a> ) <a class="code" href="classInitialConfigurationGroup.html#ac2ef20a53da6bbd710051417ccf102a6">NIC</a>=1; <span class="comment">// ÉèÅ[ÉÄê∂ê¨ÇÃèÍçá </span>
<a name="l00621"></a>00621   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> out=0; out&lt;<a class="code" href="classInitialConfigurationGroup.html#ad2e978411f291e4018c6291e9d4a6deb">NLEG</a>; out++) {
<a name="l00622"></a>00622     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> xout=0; xout&lt;<a class="code" href="dla__alg_8h.html#a52b41a08e36114fbb78f5d900f0371b9">NXMAX</a>; xout++) { 
<a name="l00623"></a>00623       <span class="comment">// xout is the new local state on the outgoing leg</span>
<a name="l00624"></a>00624       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d=0; d&lt;<a class="code" href="classInitialConfigurationGroup.html#ad2e978411f291e4018c6291e9d4a6deb">NLEG</a>; d++) y[d] = x[d];
<a name="l00625"></a>00625       y[out] = xout;
<a name="l00626"></a>00626       <span class="keywordtype">int</span> stf = INDX(y);
<a name="l00627"></a>00627       <span class="keywordflow">if</span> ( stf == <a class="code" href="namespaceSTATE.html#a6af3477d2e74163c155b0d0a2e4265ae">STATE::UNDEF</a> ) <span class="keywordflow">continue</span>;
<a name="l00628"></a>00628       <span class="keywordflow">if</span> ( <a class="code" href="classInitialConfigurationGroup.html#a075af34a843191d8a1dc1cb9db262c8b">V</a>().<a class="code" href="dla__alg_8h.html#aa6f285b73f7bfee462f5227d73db8ddb">testForbidden</a>(stf) ) <span class="keywordflow">continue</span>; 
<a name="l00629"></a>00629       <a class="code" href="classInitialConfigurationGroup.html#ac2ef20a53da6bbd710051417ccf102a6">NIC</a>++;
<a name="l00630"></a>00630     }  
<a name="l00631"></a>00631   }
<a name="l00632"></a>00632 
<a name="l00633"></a>00633   <a class="code" href="classInitialConfigurationGroup.html#a0101243218ad5586b290bc1fbd8051a3">U</a>.<a class="code" href="classArray.html#a5fd83b4910658540977272a168cfbdae">init</a>(<span class="stringliteral">&quot;U&quot;</span>,1,<a class="code" href="classInitialConfigurationGroup.html#ac2ef20a53da6bbd710051417ccf102a6">NIC</a>);
<a name="l00634"></a>00634   <a class="code" href="classInitialConfigurationGroup.html#a0101243218ad5586b290bc1fbd8051a3">U</a>.<a class="code" href="classArray.html#a46c36a9a7be294d4f647798d07c79c7e">set_all</a>(0.0);
<a name="l00635"></a>00635   <span class="comment">//  W.init(&quot;W&quot;,2,NIC,NIC);</span>
<a name="l00636"></a>00636   <span class="comment">//  W.set_all(0.0);</span>
<a name="l00637"></a>00637   <span class="comment">//  P.init(&quot;P&quot;,2,NIC,NIC);</span>
<a name="l00638"></a>00638   <span class="comment">//  P.set_all(0.0);</span>
<a name="l00639"></a>00639   <a class="code" href="classInitialConfigurationGroup.html#a3fab21a5c15ed8b5668a2cc3bf6c575d">IC</a>.<a class="code" href="classArray.html#a5fd83b4910658540977272a168cfbdae">init</a>(1,<a class="code" href="classInitialConfigurationGroup.html#ac2ef20a53da6bbd710051417ccf102a6">NIC</a>);
<a name="l00640"></a>00640 
<a name="l00641"></a>00641   <span class="keywordtype">int</span> ic=0;
<a name="l00642"></a>00642   <span class="keywordflow">if</span> ( inc == <a class="code" href="namespaceDIR.html#a6af3477d2e74163c155b0d0a2e4265ae">DIR::UNDEF</a> ) { <span class="comment">// ÉèÅ[ÉÄê∂ê¨ÇÃèÍçá</span>
<a name="l00643"></a>00643     <a class="code" href="classInitialConfigurationGroup.html#a3fab21a5c15ed8b5668a2cc3bf6c575d">IC</a>[ic].<a class="code" href="classArray.html#a5fd83b4910658540977272a168cfbdae">init</a>( <a class="code" href="classInitialConfigurationGroup.html#a075af34a843191d8a1dc1cb9db262c8b">V</a>(), sti, inc, xinc, <a class="code" href="classInitialConfigurationGroup.html#ac2ef20a53da6bbd710051417ccf102a6">NIC</a> );
<a name="l00644"></a>00644     ic++;
<a name="l00645"></a>00645   }
<a name="l00646"></a>00646   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> out=0; out&lt;<a class="code" href="classInitialConfigurationGroup.html#ad2e978411f291e4018c6291e9d4a6deb">NLEG</a>; out++) {
<a name="l00647"></a>00647     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> xout=0; xout&lt;<a class="code" href="dla__alg_8h.html#a52b41a08e36114fbb78f5d900f0371b9">NXMAX</a>; xout++) { 
<a name="l00648"></a>00648     <span class="comment">// xout is the new local state on the outgoing leg</span>
<a name="l00649"></a>00649       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d=0; d&lt;<a class="code" href="classInitialConfigurationGroup.html#ad2e978411f291e4018c6291e9d4a6deb">NLEG</a>; d++) y[d] = x[d];
<a name="l00650"></a>00650       y[out] = xout;
<a name="l00651"></a>00651       <span class="comment">/*</span>
<a name="l00652"></a>00652 <span class="comment">printf(&quot; (&quot;);</span>
<a name="l00653"></a>00653 <span class="comment">for (int i=0; i&lt;INDX.dimension(); i++) printf(&quot; %d&quot;, y[i]);</span>
<a name="l00654"></a>00654 <span class="comment">printf(&quot;)\n&quot;);</span>
<a name="l00655"></a>00655 <span class="comment">      */</span>
<a name="l00656"></a>00656       <span class="keywordtype">int</span> stf = INDX(y);
<a name="l00657"></a>00657       <span class="keywordflow">if</span> ( stf == <a class="code" href="namespaceSTATE.html#a6af3477d2e74163c155b0d0a2e4265ae">STATE::UNDEF</a> ) <span class="keywordflow">continue</span>;
<a name="l00658"></a>00658       <span class="keywordflow">if</span> ( <a class="code" href="classInitialConfigurationGroup.html#a075af34a843191d8a1dc1cb9db262c8b">V</a>().<a class="code" href="dla__alg_8h.html#aa6f285b73f7bfee462f5227d73db8ddb">testForbidden</a>(stf) ) <span class="keywordflow">continue</span>; 
<a name="l00659"></a>00659       <a class="code" href="classInitialConfigurationGroup.html#a3fab21a5c15ed8b5668a2cc3bf6c575d">IC</a>[ic].<a class="code" href="classArray.html#a5fd83b4910658540977272a168cfbdae">init</a>( <a class="code" href="classInitialConfigurationGroup.html#a075af34a843191d8a1dc1cb9db262c8b">V</a>(), stf, out, x[out], <a class="code" href="classInitialConfigurationGroup.html#ac2ef20a53da6bbd710051417ccf102a6">NIC</a> );
<a name="l00660"></a>00660       <a class="code" href="classInitialConfigurationGroup.html#a075af34a843191d8a1dc1cb9db262c8b">V</a>().<a class="code" href="classVERTEX.html#a722d16497db8771d93b3dc55c9729fef">checked</a>( stf , out , x[out]) = 1;
<a name="l00661"></a>00661       ic++;
<a name="l00662"></a>00662     }  
<a name="l00663"></a>00663   }
<a name="l00664"></a>00664   <span class="keyword">delete</span> []x;
<a name="l00665"></a>00665   <span class="keyword">delete</span> []y;
<a name="l00666"></a>00666 <span class="comment">//if (MON) printf(&quot;InitialConfigurationGroup::init&gt; End.\n&quot;);</span>
<a name="l00667"></a>00667 
<a name="l00668"></a>00668 }
<a name="l00669"></a>00669 
<a name="l00670"></a>00670 <span class="comment">//======================================================================</span>
<a name="l00671"></a>00671 
<a name="l00672"></a><a class="code" href="classInitialConfigurationGroup.html#a61a8b33c0a1a82d50982964b857c20cc">00672</a> <span class="keywordtype">int</span> <a class="code" href="classInitialConfigurationGroup.html#a61a8b33c0a1a82d50982964b857c20cc">InitialConfigurationGroup::NumberOfValidInitialConfigurations</a>() {
<a name="l00673"></a>00673   <span class="keywordtype">int</span> c = 0;
<a name="l00674"></a>00674   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classInitialConfigurationGroup.html#ac2ef20a53da6bbd710051417ccf102a6">NIC</a>; i++) {
<a name="l00675"></a>00675     <span class="keywordflow">if</span> ( <a class="code" href="classInitialConfigurationGroup.html#a3fab21a5c15ed8b5668a2cc3bf6c575d">IC</a>[i].isValid() ) c++;
<a name="l00676"></a>00676   }
<a name="l00677"></a>00677   <span class="keywordflow">return</span> c;
<a name="l00678"></a>00678 }
<a name="l00679"></a>00679 
<a name="l00680"></a>00680 <span class="comment">//======================================================================</span>
<a name="l00681"></a>00681 
<a name="l00682"></a><a class="code" href="classInitialConfigurationGroup.html#ae0c5fed98c4283eb8d16f8e08a2e2dda">00682</a> <span class="keywordtype">void</span> <a class="code" href="classInitialConfigurationGroup.html#ae0c5fed98c4283eb8d16f8e08a2e2dda">InitialConfigurationGroup::ResetWeight</a>() {
<a name="l00683"></a>00683   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classInitialConfigurationGroup.html#ac2ef20a53da6bbd710051417ccf102a6">NIC</a>; i++) {
<a name="l00684"></a>00684     <a class="code" href="classInitialConfigurationGroup.html#a0101243218ad5586b290bc1fbd8051a3">U</a>[i] = <a class="code" href="classInitialConfigurationGroup.html#a3fab21a5c15ed8b5668a2cc3bf6c575d">IC</a>[i].weight();
<a name="l00685"></a>00685     <span class="comment">/*</span>
<a name="l00686"></a>00686 <span class="comment">    for (int j=0; j&lt;NIC; j++) {</span>
<a name="l00687"></a>00687 <span class="comment">      W(i,j) = 0.0;</span>
<a name="l00688"></a>00688 <span class="comment">      P(i,j) = 0.0;</span>
<a name="l00689"></a>00689 <span class="comment">    }</span>
<a name="l00690"></a>00690 <span class="comment">    */</span>
<a name="l00691"></a>00691   }
<a name="l00692"></a>00692 }
<a name="l00693"></a>00693 
<a name="l00694"></a>00694 <span class="comment">//======================================================================</span>
<a name="l00695"></a>00695 
<a name="l00696"></a><a class="code" href="classInitialConfigurationGroup.html#adbfac79073326637e0d4dff67b2e1e05">00696</a> <span class="keywordtype">int</span> <a class="code" href="classInitialConfigurationGroup.html#adbfac79073326637e0d4dff67b2e1e05">InitialConfigurationGroup::number_of_diagonal_states</a>() {
<a name="l00697"></a>00697   <span class="keywordtype">int</span> n = 0;
<a name="l00698"></a>00698   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classInitialConfigurationGroup.html#ac2ef20a53da6bbd710051417ccf102a6">NIC</a>; i++) { <span class="keywordflow">if</span> ( ! <a class="code" href="classInitialConfigurationGroup.html#a3fab21a5c15ed8b5668a2cc3bf6c575d">IC</a>[i].<a class="code" href="dla__alg_8h.html#ae7e84b92e5385c13642109f861c4386a">isKink</a>() ) n++; }
<a name="l00699"></a>00699   <span class="keywordflow">return</span> n;
<a name="l00700"></a>00700 }
<a name="l00701"></a>00701 
<a name="l00702"></a>00702 <span class="comment">//======================================================================</span>
<a name="l00703"></a>00703 
<a name="l00704"></a><a class="code" href="classInitialConfigurationGroup.html#a6f17f0c4f4dd41628991cdefc05abc86">00704</a> <span class="keywordtype">int</span> <a class="code" href="classInitialConfigurationGroup.html#a6f17f0c4f4dd41628991cdefc05abc86">InitialConfigurationGroup::number_of_offdiagonal_states</a>() {
<a name="l00705"></a>00705   <span class="keywordflow">return</span> <a class="code" href="classInitialConfigurationGroup.html#ac2ef20a53da6bbd710051417ccf102a6">NIC</a> - <a class="code" href="classInitialConfigurationGroup.html#adbfac79073326637e0d4dff67b2e1e05">number_of_diagonal_states</a>();
<a name="l00706"></a>00706 }
<a name="l00707"></a>00707 
<a name="l00708"></a>00708 <span class="comment">//======================================================================</span>
<a name="l00709"></a>00709 
<a name="l00710"></a><a class="code" href="classInitialConfigurationGroup.html#a5600254c42d9f9f928ba52a058971195">00710</a> <span class="keywordtype">double</span> <a class="code" href="classInitialConfigurationGroup.html#a5600254c42d9f9f928ba52a058971195">InitialConfigurationGroup::minimum_diagonal_weight</a>() {
<a name="l00711"></a>00711   <span class="keywordtype">double</span> dmin = <a class="code" href="name_8h.html#a12c2040f25d8e3a7b9e1c2024c618cb6">INF</a>;
<a name="l00712"></a>00712   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classInitialConfigurationGroup.html#ac2ef20a53da6bbd710051417ccf102a6">NIC</a>; i++) {
<a name="l00713"></a>00713     <span class="keywordflow">if</span> ( ! <a class="code" href="classInitialConfigurationGroup.html#a3fab21a5c15ed8b5668a2cc3bf6c575d">IC</a>[i].<a class="code" href="dla__alg_8h.html#ae7e84b92e5385c13642109f861c4386a">isKink</a>() ) {
<a name="l00714"></a>00714       <span class="keywordflow">if</span> ( <a class="code" href="classInitialConfigurationGroup.html#a0101243218ad5586b290bc1fbd8051a3">U</a>[i] &lt; dmin ) dmin = <a class="code" href="classInitialConfigurationGroup.html#a0101243218ad5586b290bc1fbd8051a3">U</a>[i];
<a name="l00715"></a>00715     }
<a name="l00716"></a>00716   }
<a name="l00717"></a>00717   <span class="keywordflow">return</span> dmin;
<a name="l00718"></a>00718 }
<a name="l00719"></a>00719 
<a name="l00720"></a>00720 <span class="comment">//======================================================================</span>
<a name="l00721"></a>00721 
<a name="l00722"></a><a class="code" href="classInitialConfigurationGroup.html#a921afdee3f0fba3c4e07d917a505575a">00722</a> <span class="keywordtype">double</span> <a class="code" href="classInitialConfigurationGroup.html#a921afdee3f0fba3c4e07d917a505575a">InitialConfigurationGroup::maximum_diagonal_weight</a>() {
<a name="l00723"></a>00723   <span class="keywordtype">double</span> dmax = -<a class="code" href="name_8h.html#a12c2040f25d8e3a7b9e1c2024c618cb6">INF</a>;
<a name="l00724"></a>00724   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classInitialConfigurationGroup.html#ac2ef20a53da6bbd710051417ccf102a6">NIC</a>; i++) {
<a name="l00725"></a>00725     <span class="keywordflow">if</span> ( ! <a class="code" href="classInitialConfigurationGroup.html#a3fab21a5c15ed8b5668a2cc3bf6c575d">IC</a>[i].<a class="code" href="dla__alg_8h.html#ae7e84b92e5385c13642109f861c4386a">isKink</a>() ) {
<a name="l00726"></a>00726       <span class="keywordflow">if</span> ( <a class="code" href="classInitialConfigurationGroup.html#a0101243218ad5586b290bc1fbd8051a3">U</a>[i] &gt; dmax ) dmax = <a class="code" href="classInitialConfigurationGroup.html#a0101243218ad5586b290bc1fbd8051a3">U</a>[i];
<a name="l00727"></a>00727     }
<a name="l00728"></a>00728   }
<a name="l00729"></a>00729   <span class="keywordflow">return</span> dmax;
<a name="l00730"></a>00730 }
<a name="l00731"></a>00731 
<a name="l00732"></a>00732 <span class="comment">//======================================================================</span>
<a name="l00733"></a>00733 
<a name="l00734"></a><a class="code" href="classInitialConfigurationGroup.html#afc332c44c634a58a5812a0349d4197b5">00734</a> <span class="keywordtype">double</span> <a class="code" href="classInitialConfigurationGroup.html#afc332c44c634a58a5812a0349d4197b5">InitialConfigurationGroup::maximum_offdiagonal_weight</a>() {
<a name="l00735"></a>00735   <span class="keywordtype">double</span> omax = -<a class="code" href="name_8h.html#a12c2040f25d8e3a7b9e1c2024c618cb6">INF</a>;
<a name="l00736"></a>00736   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classInitialConfigurationGroup.html#ac2ef20a53da6bbd710051417ccf102a6">NIC</a>; i++) {
<a name="l00737"></a>00737     <span class="keywordflow">if</span> ( <a class="code" href="classInitialConfigurationGroup.html#a3fab21a5c15ed8b5668a2cc3bf6c575d">IC</a>[i].<a class="code" href="dla__alg_8h.html#ae7e84b92e5385c13642109f861c4386a">isKink</a>() ) {
<a name="l00738"></a>00738       <span class="keywordflow">if</span> ( <a class="code" href="classInitialConfigurationGroup.html#a0101243218ad5586b290bc1fbd8051a3">U</a>[i] &gt; omax ) omax = <a class="code" href="classInitialConfigurationGroup.html#a0101243218ad5586b290bc1fbd8051a3">U</a>[i];
<a name="l00739"></a>00739     }
<a name="l00740"></a>00740   }
<a name="l00741"></a>00741   <span class="keywordflow">return</span> omax;
<a name="l00742"></a>00742 }
<a name="l00743"></a>00743 
<a name="l00744"></a>00744 <span class="comment">//======================================================================</span>
<a name="l00745"></a>00745 
<a name="l00746"></a><a class="code" href="classInitialConfigurationGroup.html#a8d59b14bde1d74067ca8d8c92dfbea42">00746</a> <span class="keywordtype">double</span> <a class="code" href="classInitialConfigurationGroup.html#a8d59b14bde1d74067ca8d8c92dfbea42">InitialConfigurationGroup::sum_of_all_weights</a>() {
<a name="l00747"></a>00747   <span class="keywordtype">double</span> sum = 0.0;
<a name="l00748"></a>00748   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classInitialConfigurationGroup.html#ac2ef20a53da6bbd710051417ccf102a6">NIC</a>; i++) sum += <a class="code" href="classInitialConfigurationGroup.html#a0101243218ad5586b290bc1fbd8051a3">U</a>[i];
<a name="l00749"></a>00749   <span class="keywordflow">return</span> sum;
<a name="l00750"></a>00750 }
<a name="l00751"></a>00751 
<a name="l00752"></a>00752 <span class="comment">//======================================================================</span>
<a name="l00753"></a>00753 
<a name="l00754"></a><a class="code" href="dla__alg_8cc.html#af1e8ecc7a5764898a4b0f9ed6da862b7">00754</a> <span class="keywordtype">double</span> <a class="code" href="dla__alg_8cc.html#af1e8ecc7a5764898a4b0f9ed6da862b7">max</a>( <span class="keywordtype">double</span>&amp; d0, <span class="keywordtype">double</span>&amp; d1, <span class="keywordtype">double</span>&amp; d2) {
<a name="l00755"></a>00755   <span class="keywordtype">double</span> d = d0;
<a name="l00756"></a>00756   <span class="keywordflow">if</span> ( d1 &gt; d ) d = d1;
<a name="l00757"></a>00757   <span class="keywordflow">if</span> ( d2 &gt; d ) d = d2;
<a name="l00758"></a>00758   <span class="keywordflow">return</span> d;
<a name="l00759"></a>00759 }
<a name="l00760"></a>00760 
<a name="l00761"></a>00761 <span class="comment">//======================================================================</span>
<a name="l00762"></a>00762 
<a name="l00763"></a><a class="code" href="classInitialConfigurationGroup.html#acb2fe234ee5fb671be3e252f7326ef83">00763</a> <span class="keywordtype">double</span> <a class="code" href="classInitialConfigurationGroup.html#acb2fe234ee5fb671be3e252f7326ef83">InitialConfigurationGroup::ebase</a>() {
<a name="l00764"></a>00764 
<a name="l00765"></a>00765 <span class="comment">//if ( MON ) printf(&quot;InitialConfigurationGroup::ebase&gt; Start.\n&quot;);</span>
<a name="l00766"></a>00766 
<a name="l00767"></a>00767   <span class="keywordtype">double</span> eb, eb0, eb1, eb2;
<a name="l00768"></a>00768 
<a name="l00769"></a>00769   <span class="keywordtype">int</span> nd = <a class="code" href="classInitialConfigurationGroup.html#adbfac79073326637e0d4dff67b2e1e05">number_of_diagonal_states</a>();
<a name="l00770"></a>00770   <span class="keywordtype">int</span> no = <a class="code" href="classInitialConfigurationGroup.html#ac2ef20a53da6bbd710051417ccf102a6">NIC</a> - nd;
<a name="l00771"></a>00771   <span class="keywordflow">if</span> ( nd == 0 ) {
<a name="l00772"></a>00772     eb = -<a class="code" href="name_8h.html#a12c2040f25d8e3a7b9e1c2024c618cb6">INF</a>; <span class="comment">// ëŒäpçÄÇ™Ç»ÇØÇÍÇŒ ebase ÇÕä÷åWÇ»Ç¢ÇÃÇ≈ÅCÇ¢Ç¬Ç≈Ç‡ÇnÇjÅD</span>
<a name="l00773"></a>00773   } <span class="keywordflow">else</span> {
<a name="l00774"></a>00774     <span class="keywordtype">double</span> dmax = <a class="code" href="classInitialConfigurationGroup.html#a921afdee3f0fba3c4e07d917a505575a">maximum_diagonal_weight</a>();
<a name="l00775"></a>00775     <span class="keywordtype">double</span> dmin = <a class="code" href="classInitialConfigurationGroup.html#a5600254c42d9f9f928ba52a058971195">minimum_diagonal_weight</a>();
<a name="l00776"></a>00776     <span class="keywordtype">double</span> omax = <a class="code" href="classInitialConfigurationGroup.html#afc332c44c634a58a5812a0349d4197b5">maximum_offdiagonal_weight</a>();
<a name="l00777"></a>00777     <span class="keywordtype">double</span> sum  = <a class="code" href="classInitialConfigurationGroup.html#a8d59b14bde1d74067ca8d8c92dfbea42">sum_of_all_weights</a>();
<a name="l00778"></a>00778     <span class="comment">// eb0 ... ç≈í·Ç±ÇÍÇæÇØÇÕë´Ç≥Ç»Ç¢Ç∆ïâÇÃëŒäpçÄÇ™Ç≈ÇƒÇµÇ‹Ç§ÅD</span>
<a name="l00779"></a>00779     <span class="comment">// eb1 ... ç≈í·Ç±ÇÍÇæÇØÇÕë´Ç≥Ç»Ç¢Ç∆îÒëŒäpèÛë‘Ç≈ÇÃÉoÉEÉìÉXÇ™î≠ê∂ÇµÇƒÇµÇ‹Ç§ÅD</span>
<a name="l00780"></a>00780     <span class="comment">// eb2 ... ç≈í·Ç±ÇÍÇæÇØÇÕë´Ç≥Ç»Ç¢Ç∆îÒëŒäpèÛë‘ä‘ÇÃíºê⁄ëJà⁄Ç™î≠ê∂ÇµÇƒÇµÇ‹Ç§ÅD</span>
<a name="l00781"></a>00781     eb0 = -dmin; 
<a name="l00782"></a>00782     eb1 = ( 2.0 * omax - sum ) / (<span class="keywordtype">double</span>)nd; 
<a name="l00783"></a>00783 <span class="comment">//  eb2 = -INF;</span>
<a name="l00784"></a>00784 <span class="comment">//  eb2 = sum - 2.0 * dmax;</span>
<a name="l00785"></a>00785     <span class="keywordflow">if</span> ( eb0 &gt;= eb1 ) { eb = eb0; } <span class="keywordflow">else</span> { eb = eb1; }
<a name="l00786"></a>00786 
<a name="l00787"></a>00787     <span class="keywordtype">double</span> ww = 0.0;
<a name="l00788"></a>00788     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classInitialConfigurationGroup.html#ac2ef20a53da6bbd710051417ccf102a6">NIC</a>; i++) {
<a name="l00789"></a>00789       <span class="keywordflow">if</span> ( ! <a class="code" href="classInitialConfigurationGroup.html#a3fab21a5c15ed8b5668a2cc3bf6c575d">IC</a>[i].<a class="code" href="dla__alg_8h.html#ae7e84b92e5385c13642109f861c4386a">isKink</a>() ) {
<a name="l00790"></a>00790         <span class="keywordtype">double</span> wt = <a class="code" href="classInitialConfigurationGroup.html#a3fab21a5c15ed8b5668a2cc3bf6c575d">IC</a>[i].worm_weight();
<a name="l00791"></a>00791         <span class="keywordflow">if</span> ( fabs(ww)&gt;<a class="code" href="name_8h.html#a6ebf6899d6c1c8b7b9d09be872c05aae">EPS</a> &amp;&amp; fabs(wt)&gt;<a class="code" href="name_8h.html#a6ebf6899d6c1c8b7b9d09be872c05aae">EPS</a> &amp;&amp; wt!=ww ) {
<a name="l00792"></a>00792           printf(<span class="stringliteral">&quot;InitialConfigurationGroup::ebase&gt; Error.\n&quot;</span>);
<a name="l00793"></a>00793           printf(<span class="stringliteral">&quot;  The worm weights of non-kinks are not equal.\n&quot;</span>);
<a name="l00794"></a>00794           <a class="code" href="classInitialConfigurationGroup.html#accd2600060dbaee3a3b41aed4034c63c">dump</a>();
<a name="l00795"></a>00795           exit(0);
<a name="l00796"></a>00796         }
<a name="l00797"></a>00797         ww = <a class="code" href="classInitialConfigurationGroup.html#a3fab21a5c15ed8b5668a2cc3bf6c575d">IC</a>[i].worm_weight();
<a name="l00798"></a>00798       }
<a name="l00799"></a>00799     }
<a name="l00800"></a>00800     <span class="comment">// Ç±Ç±Ç‹Ç≈ÉnÉ~ÉãÉgÉjÉAÉìèdÇ›Ç…ÉèÅ[ÉÄèdÇ›ÇÇ©ÇØÇΩÇ‡ÇÃÇ…äÓÇ√Ç¢Çƒ eb Ç</span>
<a name="l00801"></a>00801     <span class="comment">// åvéZÇµÇƒÇ´ÇΩÇ™ÅCEBASE ÇÕç≈èIìIÇ…ÇÕÉnÉ~ÉãÉgÉjÉAÉìÇ÷ÇÃïtâ¡çÄ</span>
<a name="l00802"></a>00802     <span class="comment">// ÇæÇ©ÇÁÉèÅ[ÉÄèdÇ›ÇÇ©ÇØÇÈÇ‹Ç¶ÇÃëÂÇ´Ç≥Ç…ñﬂÇ≥Ç»Ç¢Ç∆Ç¢ÇØÇ»Ç¢ÅD</span>
<a name="l00803"></a>00803     eb /= ww; 
<a name="l00804"></a>00804   }
<a name="l00805"></a>00805 
<a name="l00806"></a>00806 <span class="comment">//if ( MON ) printf(&quot;InitialConfigurationGroup::ebase&gt; End.\n&quot;);</span>
<a name="l00807"></a>00807 
<a name="l00808"></a>00808   <span class="keywordflow">return</span> eb;
<a name="l00809"></a>00809 
<a name="l00810"></a>00810 }
<a name="l00811"></a>00811 
<a name="l00812"></a>00812 <span class="comment">//======================================================================</span>
<a name="l00813"></a>00813 
<a name="l00814"></a><a class="code" href="classInitialConfigurationGroup.html#adb2f3a401a06222c05e8b1656a09e302">00814</a> <span class="keywordtype">void</span> <a class="code" href="classInitialConfigurationGroup.html#adb2f3a401a06222c05e8b1656a09e302">InitialConfigurationGroup::add_to_diagonal_element</a>(<span class="keywordtype">double</span> E) {
<a name="l00815"></a>00815 
<a name="l00816"></a>00816   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classInitialConfigurationGroup.html#ac2ef20a53da6bbd710051417ccf102a6">NIC</a>; i++) {
<a name="l00817"></a>00817     <span class="keywordflow">if</span> ( ! <a class="code" href="classInitialConfigurationGroup.html#a3fab21a5c15ed8b5668a2cc3bf6c575d">IC</a>[i].<a class="code" href="dla__alg_8h.html#ae7e84b92e5385c13642109f861c4386a">isKink</a>() ) <a class="code" href="classInitialConfigurationGroup.html#a0101243218ad5586b290bc1fbd8051a3">U</a>[i] += E;
<a name="l00818"></a>00818   }
<a name="l00819"></a>00819 
<a name="l00820"></a>00820 }
<a name="l00821"></a>00821 
<a name="l00822"></a>00822 <span class="comment">//======================================================================</span>
<a name="l00823"></a>00823 
<a name="l00824"></a><a class="code" href="classInitialConfigurationGroup.html#a7c48614b600846f95d9e65681bfe8588">00824</a> <span class="keywordtype">void</span> <a class="code" href="classInitialConfigurationGroup.html#a7c48614b600846f95d9e65681bfe8588">InitialConfigurationGroup::numbering</a>(<span class="keywordtype">int</span>&amp; ic) {
<a name="l00825"></a>00825 
<a name="l00826"></a>00826   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classInitialConfigurationGroup.html#ac2ef20a53da6bbd710051417ccf102a6">NIC</a>; i++) {
<a name="l00827"></a>00827     <span class="keywordflow">if</span> ( <a class="code" href="classInitialConfigurationGroup.html#a0101243218ad5586b290bc1fbd8051a3">U</a>[i] &gt; -<a class="code" href="name_8h.html#a6ebf6899d6c1c8b7b9d09be872c05aae">EPS</a> &amp;&amp; <a class="code" href="classInitialConfigurationGroup.html#a0101243218ad5586b290bc1fbd8051a3">U</a>[i] &lt; <a class="code" href="name_8h.html#a6ebf6899d6c1c8b7b9d09be872c05aae">EPS</a> ) {
<a name="l00828"></a>00828       <a class="code" href="classInitialConfigurationGroup.html#a3fab21a5c15ed8b5668a2cc3bf6c575d">IC</a>[i].id() = <a class="code" href="namespaceSTYPE.html#a6af3477d2e74163c155b0d0a2e4265ae">ICONF::UNDEF</a>;
<a name="l00829"></a>00829     } <span class="keywordflow">else</span> {
<a name="l00830"></a>00830       <a class="code" href="classInitialConfigurationGroup.html#a3fab21a5c15ed8b5668a2cc3bf6c575d">IC</a>[i].id() = ic;
<a name="l00831"></a>00831       ic++;
<a name="l00832"></a>00832     }
<a name="l00833"></a>00833   }
<a name="l00834"></a>00834 
<a name="l00835"></a>00835 }
<a name="l00836"></a>00836 
<a name="l00837"></a>00837 <span class="comment">//======================================================================</span>
<a name="l00838"></a>00838 
<a name="l00839"></a><a class="code" href="classInitialConfigurationGroup.html#a21991132691d4646e8ab528a6354612f">00839</a> <span class="keywordtype">void</span> <a class="code" href="classInitialConfigurationGroup.html#a21991132691d4646e8ab528a6354612f">InitialConfigurationGroup::ScatteringProbability</a>() {
<a name="l00840"></a>00840 
<a name="l00841"></a>00841 <span class="comment">//printf(&quot;\nInitialConfigurationGroup::ScatteringProbability&gt; Start. ICG= %d\n&quot;, ID);</span>
<a name="l00842"></a>00842 <span class="comment">//if (MON) dump();</span>
<a name="l00843"></a>00843 
<a name="l00844"></a>00844 <span class="comment">// NIC ÇÕénèÛë‘ÇÃêîÅDU ÇÕénèÛë‘ÇÃèdÇ›ÅDUP ÇÕëÂÇ´Ç≥èáÇ…ï¿Ç◊ë÷Ç¶ÇΩèdÇ›ÅD</span>
<a name="l00845"></a>00845   <a class="code" href="classArray.html">Array&lt;int&gt;</a> PERM(<span class="stringliteral">&quot;PERM&quot;</span>);
<a name="l00846"></a>00846   PERM.<a class="code" href="classArray.html#a5fd83b4910658540977272a168cfbdae">init</a>(1,<a class="code" href="classInitialConfigurationGroup.html#ac2ef20a53da6bbd710051417ccf102a6">NIC</a>);
<a name="l00847"></a>00847   <a class="code" href="dla__alg_8cc.html#ac16b7b50b923317227f20002e977d596">bubble_sort</a>( <a class="code" href="classInitialConfigurationGroup.html#ac2ef20a53da6bbd710051417ccf102a6">NIC</a> , <a class="code" href="classInitialConfigurationGroup.html#a0101243218ad5586b290bc1fbd8051a3">U</a> , PERM ); 
<a name="l00848"></a>00848 
<a name="l00849"></a>00849   <a class="code" href="classArray.html">Array&lt;double&gt;</a> <a class="code" href="namespaceUORD.html#ad0fc305cdc38dbbd4a06e816a88a0571">UP</a>(<span class="stringliteral">&quot;UP&quot;</span>);
<a name="l00850"></a>00850   UP.<a class="code" href="classArray.html#a5fd83b4910658540977272a168cfbdae">init</a>(1,<a class="code" href="classInitialConfigurationGroup.html#ac2ef20a53da6bbd710051417ccf102a6">NIC</a>);
<a name="l00851"></a>00851   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classInitialConfigurationGroup.html#ac2ef20a53da6bbd710051417ccf102a6">NIC</a>; i++) { UP[i] = <a class="code" href="classInitialConfigurationGroup.html#a0101243218ad5586b290bc1fbd8051a3">U</a>[PERM[i]]; }
<a name="l00852"></a>00852 
<a name="l00853"></a>00853   <a class="code" href="classArray.html">Array&lt;double&gt;</a> P(<span class="stringliteral">&quot;P&quot;</span>);
<a name="l00854"></a>00854   <a class="code" href="classArray.html">Array&lt;double&gt;</a> W(<span class="stringliteral">&quot;W&quot;</span>);
<a name="l00855"></a>00855   <a class="code" href="classArray.html">Array&lt;double&gt;</a> WP(<span class="stringliteral">&quot;WP&quot;</span>);
<a name="l00856"></a>00856   P.<a class="code" href="classArray.html#a5fd83b4910658540977272a168cfbdae">init</a>(2,NIC,NIC);
<a name="l00857"></a>00857   W.<a class="code" href="classArray.html#a5fd83b4910658540977272a168cfbdae">init</a>(2,NIC,NIC);
<a name="l00858"></a>00858   WP.<a class="code" href="classArray.html#a5fd83b4910658540977272a168cfbdae">init</a>(2,NIC,NIC);
<a name="l00859"></a>00859 
<a name="l00860"></a>00860   <a class="code" href="dla__alg_8cc.html#aeab06fd759525e7c94929ec5ed89a974">SolveWeightEquation</a>(NIC,UP,WP);
<a name="l00861"></a>00861 
<a name="l00862"></a>00862 <span class="comment">/*</span>
<a name="l00863"></a>00863 <span class="comment">  for (int i=0; i&lt;NIC; i++) { </span>
<a name="l00864"></a>00864 <span class="comment">    for (int j=0; j&lt;NIC; j++) W(PERM[i],PERM[j]) = WP(i,j); </span>
<a name="l00865"></a>00865 <span class="comment">  }</span>
<a name="l00866"></a>00866 <span class="comment">*/</span>
<a name="l00867"></a>00867 
<a name="l00868"></a>00868   <a class="code" href="classIndexSystem.html">IndexSystem</a>&amp; INDX = <a class="code" href="classInitialConfigurationGroup.html#a075af34a843191d8a1dc1cb9db262c8b">V</a>().<a class="code" href="classVERTEX.html#af0261ee9ed4d08c911429c30fba45bae">INDX</a>();
<a name="l00869"></a>00869   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classInitialConfigurationGroup.html#ac2ef20a53da6bbd710051417ccf102a6">NIC</a>; i++) {
<a name="l00870"></a>00870     <span class="keywordtype">int</span> I = PERM[i];
<a name="l00871"></a>00871     <span class="keywordflow">if</span> ( -<a class="code" href="name_8h.html#a6ebf6899d6c1c8b7b9d09be872c05aae">EPS</a> &lt; <a class="code" href="classInitialConfigurationGroup.html#a0101243218ad5586b290bc1fbd8051a3">U</a>[I] &amp;&amp; <a class="code" href="classInitialConfigurationGroup.html#a0101243218ad5586b290bc1fbd8051a3">U</a>[I] &lt; <a class="code" href="name_8h.html#a6ebf6899d6c1c8b7b9d09be872c05aae">EPS</a> ) <span class="keywordflow">continue</span>;
<a name="l00872"></a>00872     <span class="keywordtype">int</span> nc = 0;
<a name="l00873"></a>00873     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;<a class="code" href="classInitialConfigurationGroup.html#ac2ef20a53da6bbd710051417ccf102a6">NIC</a>; j++) {
<a name="l00874"></a>00874       <span class="keywordtype">int</span> J = PERM[j];
<a name="l00875"></a>00875       <span class="keywordflow">if</span> ( -<a class="code" href="name_8h.html#a6ebf6899d6c1c8b7b9d09be872c05aae">EPS</a> &lt; <a class="code" href="classInitialConfigurationGroup.html#a0101243218ad5586b290bc1fbd8051a3">U</a>[J] &amp;&amp; <a class="code" href="classInitialConfigurationGroup.html#a0101243218ad5586b290bc1fbd8051a3">U</a>[J] &lt; <a class="code" href="name_8h.html#a6ebf6899d6c1c8b7b9d09be872c05aae">EPS</a> ) <span class="keywordflow">continue</span>;
<a name="l00876"></a>00876       W(I,J) = WP(i,j);
<a name="l00877"></a>00877       P(I,J) = W(I,J) / <a class="code" href="classInitialConfigurationGroup.html#a0101243218ad5586b290bc1fbd8051a3">U</a>[I];
<a name="l00878"></a>00878       <span class="keywordflow">if</span> ( P(I,J) &gt; <a class="code" href="name_8h.html#a6ebf6899d6c1c8b7b9d09be872c05aae">EPS</a> ) {
<a name="l00879"></a>00879         <span class="keywordtype">double</span> p = P(I,J);
<a name="l00880"></a>00880         <span class="keywordtype">int</span> stf = <a class="code" href="classInitialConfigurationGroup.html#a3fab21a5c15ed8b5668a2cc3bf6c575d">IC</a>[J].STI;
<a name="l00881"></a>00881         <span class="keywordtype">int</span> out = <a class="code" href="classInitialConfigurationGroup.html#a3fab21a5c15ed8b5668a2cc3bf6c575d">IC</a>[J].INC;
<a name="l00882"></a>00882         <span class="keywordtype">int</span> xout = <a class="code" href="namespaceSTYPE.html#a6af3477d2e74163c155b0d0a2e4265ae">STATE::UNDEF</a>;
<a name="l00883"></a>00883         <span class="keywordflow">if</span> ( out != <a class="code" href="namespaceDIR.html#a6af3477d2e74163c155b0d0a2e4265ae">DIR::UNDEF</a> ) {
<a name="l00884"></a>00884           xout = INDX.<a class="code" href="classIndexSystem.html#a4f12ec2efb69b48e312e4ef7c400492c">coord</a>( stf , out );
<a name="l00885"></a>00885         }
<a name="l00886"></a>00886         <a class="code" href="classInitialConfigurationGroup.html#a3fab21a5c15ed8b5668a2cc3bf6c575d">IC</a>[I].FinalDirection[nc] = out;
<a name="l00887"></a>00887         <a class="code" href="classInitialConfigurationGroup.html#a3fab21a5c15ed8b5668a2cc3bf6c575d">IC</a>[I].FinalState[nc] = xout;
<a name="l00888"></a>00888         <a class="code" href="classInitialConfigurationGroup.html#a3fab21a5c15ed8b5668a2cc3bf6c575d">IC</a>[I].ScatteringProbability[nc] = p;
<a name="l00889"></a>00889         nc++;
<a name="l00890"></a>00890       }
<a name="l00891"></a>00891     }
<a name="l00892"></a>00892     <a class="code" href="classInitialConfigurationGroup.html#a3fab21a5c15ed8b5668a2cc3bf6c575d">IC</a>[I].NCH = nc;
<a name="l00893"></a>00893   }
<a name="l00894"></a>00894 
<a name="l00895"></a>00895 <span class="comment">//if (MON) printf(&quot;  ==&gt;\n&quot;);</span>
<a name="l00896"></a>00896 
<a name="l00897"></a>00897 }
<a name="l00898"></a>00898 
<a name="l00899"></a>00899 <span class="comment">//======================================================================</span>
<a name="l00900"></a>00900 
<a name="l00901"></a><a class="code" href="classInitialConfigurationGroup.html#accd2600060dbaee3a3b41aed4034c63c">00901</a> <span class="keywordtype">void</span> <a class="code" href="classInitialConfigurationGroup.html#accd2600060dbaee3a3b41aed4034c63c">InitialConfigurationGroup::dump</a>() {
<a name="l00902"></a>00902   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classInitialConfigurationGroup.html#ac2ef20a53da6bbd710051417ccf102a6">NIC</a>; i++) {
<a name="l00903"></a>00903     <a class="code" href="classInitialConfigurationGroup.html#a3fab21a5c15ed8b5668a2cc3bf6c575d">IC</a>[i].<a class="code" href="classArray.html#aecb7287b27cc6e843cee2ed2f8de8ade">dump</a>();
<a name="l00904"></a>00904   }
<a name="l00905"></a>00905   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classInitialConfigurationGroup.html#ac2ef20a53da6bbd710051417ccf102a6">NIC</a>; i++) {
<a name="l00906"></a>00906     printf(<span class="stringliteral">&quot;(%d)&quot;</span>, i);
<a name="l00907"></a>00907     printf(<span class="stringliteral">&quot; ID= %2d&quot;</span>, <a class="code" href="classInitialConfigurationGroup.html#a3fab21a5c15ed8b5668a2cc3bf6c575d">IC</a>[i].<span class="keywordtype">id</span>());
<a name="l00908"></a>00908     printf(<span class="stringliteral">&quot; : U= %4.1f&quot;</span>, <a class="code" href="classInitialConfigurationGroup.html#a0101243218ad5586b290bc1fbd8051a3">U</a>[i]);
<a name="l00909"></a>00909     <span class="comment">/*</span>
<a name="l00910"></a>00910 <span class="comment">    printf(&quot; , W= &quot;);</span>
<a name="l00911"></a>00911 <span class="comment">    for (int j=0; j&lt;NIC; j++) {</span>
<a name="l00912"></a>00912 <span class="comment">      printf(&quot; %4.1f&quot;, W(i,j));</span>
<a name="l00913"></a>00913 <span class="comment">    }</span>
<a name="l00914"></a>00914 <span class="comment">    printf(&quot; , P= &quot;);</span>
<a name="l00915"></a>00915 <span class="comment">    for (int j=0; j&lt;NIC; j++) {</span>
<a name="l00916"></a>00916 <span class="comment">      printf(&quot; %6.3f&quot;, P(i,j));</span>
<a name="l00917"></a>00917 <span class="comment">    }</span>
<a name="l00918"></a>00918 <span class="comment">    printf(&quot;\n&quot;);</span>
<a name="l00919"></a>00919 <span class="comment">    */</span>
<a name="l00920"></a>00920   }  
<a name="l00921"></a>00921 }
<a name="l00922"></a>00922 
<a name="l00923"></a>00923 <span class="comment">//======================================================================</span>
<a name="l00924"></a>00924 
<a name="l00925"></a><a class="code" href="classInitialConfigurationGroup.html#aac759501cf6c7895a70eecbef0226ae1">00925</a> <span class="keywordtype">void</span> <a class="code" href="classInitialConfigurationGroup.html#aac759501cf6c7895a70eecbef0226ae1">InitialConfigurationGroup::write</a>() {
<a name="l00926"></a>00926   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classInitialConfigurationGroup.html#ac2ef20a53da6bbd710051417ccf102a6">NIC</a>; i++) {
<a name="l00927"></a>00927     <a class="code" href="classInitialConfigurationGroup.html#a3fab21a5c15ed8b5668a2cc3bf6c575d">IC</a>[i].write();
<a name="l00928"></a>00928   }
<a name="l00929"></a>00929 }
<a name="l00930"></a>00930 
<a name="l00931"></a>00931 <span class="comment">//######################################################################</span>
<a name="l00932"></a>00932 
<a name="l00933"></a><a class="code" href="classInitialConfiguration.html#a76c143907e710b4c6f184ed29df8bd9f">00933</a> <span class="keywordtype">void</span> <a class="code" href="classInitialConfiguration.html#a76c143907e710b4c6f184ed29df8bd9f">InitialConfiguration::init</a>( 
<a name="l00934"></a>00934   <a class="code" href="classVERTEX.html">VERTEX</a>&amp; v, <span class="keywordtype">int</span> sti , <span class="keywordtype">int</span> inc , <span class="keywordtype">int</span> xinc, <span class="keywordtype">int</span> NICmax ) {
<a name="l00935"></a>00935   <span class="comment">// define an initial configuration for which</span>
<a name="l00936"></a>00936   <span class="comment">// the initial vertex state is &quot;sti&quot;</span>
<a name="l00937"></a>00937   <span class="comment">// the incoming worm head is coming on the &quot;inc&quot;-th leg</span>
<a name="l00938"></a>00938   <span class="comment">// the new state on the leg after the passage of the worm head is &quot;xinc&quot;</span>
<a name="l00939"></a>00939 
<a name="l00940"></a>00940   <a class="code" href="classInitialConfiguration.html#a1164e5678e2ef427620d7fcd96365739">setV</a>(v);
<a name="l00941"></a>00941   <a class="code" href="classInitialConfiguration.html#a92297bc6de760f10ff2e8f4e25ecac0b">STI</a> = sti;
<a name="l00942"></a>00942   <a class="code" href="classInitialConfiguration.html#a66e9afc35cfde27c7f2c650df188c0c8">INC</a> = inc;
<a name="l00943"></a>00943   <a class="code" href="classInitialConfiguration.html#a8f747dc37066722ae97fb0edbb79ee71">XINC</a> = xinc;
<a name="l00944"></a>00944   <a class="code" href="classInitialConfiguration.html#ad2e978411f291e4018c6291e9d4a6deb">NLEG</a> = <a class="code" href="classInitialConfiguration.html#a075af34a843191d8a1dc1cb9db262c8b">V</a>().<a class="code" href="classVERTEX.html#ad2e978411f291e4018c6291e9d4a6deb">NLEG</a>;
<a name="l00945"></a>00945   <a class="code" href="classInitialConfiguration.html#a40b6cb423d67e694bd442231902c4b06">NBODY</a> = 2 * <a class="code" href="classInitialConfiguration.html#ad2e978411f291e4018c6291e9d4a6deb">NLEG</a>;
<a name="l00946"></a>00946   <a class="code" href="classInitialConfiguration.html#a1b922b6523bd302b3a36812b23c4eebb">State</a> = <span class="keyword">new</span> <span class="keywordtype">int</span>[<a class="code" href="classInitialConfiguration.html#ad2e978411f291e4018c6291e9d4a6deb">NLEG</a>];
<a name="l00947"></a>00947   <a class="code" href="classInitialConfiguration.html#ab861732a67ffb9d9c9cc061b0d77faae">ScatteringProbability</a> = <span class="keyword">new</span> <span class="keywordtype">double</span>[NICmax];
<a name="l00948"></a>00948   <a class="code" href="classInitialConfiguration.html#a228ef943ea00843456f11a742a1426aa">FinalState</a> = <span class="keyword">new</span> <span class="keywordtype">int</span>[NICmax];
<a name="l00949"></a>00949   <a class="code" href="classInitialConfiguration.html#af60991908d4085d9b1282624853d053e">FinalDirection</a> = <span class="keyword">new</span> <span class="keywordtype">int</span>[NICmax];
<a name="l00950"></a>00950   <a class="code" href="classInitialConfiguration.html#a075af34a843191d8a1dc1cb9db262c8b">V</a>().<a class="code" href="classVERTEX.html#af0261ee9ed4d08c911429c30fba45bae">INDX</a>().<a class="code" href="classIndexSystem.html#a4f12ec2efb69b48e312e4ef7c400492c">coord</a>(<a class="code" href="classInitialConfiguration.html#a92297bc6de760f10ff2e8f4e25ecac0b">STI</a>,<a class="code" href="classInitialConfiguration.html#a1b922b6523bd302b3a36812b23c4eebb">State</a>);
<a name="l00951"></a>00951   <a class="code" href="classInitialConfiguration.html#abec7c8ef75bc4b811f2eb3d4e8db6d2b">NCH</a> = 0;
<a name="l00952"></a>00952 }
<a name="l00953"></a>00953 
<a name="l00954"></a>00954 <span class="comment">//======================================================================</span>
<a name="l00955"></a>00955 
<a name="l00956"></a><a class="code" href="classInitialConfiguration.html#afe93e17ac89cd97917811068ba2af214">00956</a> <span class="keywordtype">bool</span> <a class="code" href="classInitialConfiguration.html#afe93e17ac89cd97917811068ba2af214">InitialConfiguration::isValid</a>() { 
<a name="l00957"></a>00957   <span class="keywordflow">if</span> ( <a class="code" href="classInitialConfiguration.html#a66e9afc35cfde27c7f2c650df188c0c8">INC</a> == <a class="code" href="namespaceDIR.html#a6af3477d2e74163c155b0d0a2e4265ae">DIR::UNDEF</a> ) <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00958"></a>00958   <span class="keywordflow">if</span> ( fabs(<a class="code" href="classInitialConfiguration.html#a513541c0b2800a99c35352af29ac8f32">weight</a>()) &lt; <a class="code" href="name_8h.html#a6ebf6899d6c1c8b7b9d09be872c05aae">EPS</a> ) <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00959"></a>00959   <span class="keywordflow">return</span> <span class="keyword">true</span>; 
<a name="l00960"></a>00960 }
<a name="l00961"></a>00961 
<a name="l00962"></a>00962 <span class="comment">//======================================================================</span>
<a name="l00963"></a>00963 
<a name="l00964"></a><a class="code" href="classInitialConfiguration.html#a0757ddb5fa3cf27ba383415646971d13">00964</a> <span class="keywordtype">bool</span> <a class="code" href="classInitialConfiguration.html#a0757ddb5fa3cf27ba383415646971d13">InitialConfiguration::isKink</a>() {
<a name="l00965"></a>00965   <span class="keywordflow">return</span> <a class="code" href="classInitialConfiguration.html#a075af34a843191d8a1dc1cb9db262c8b">V</a>().<a class="code" href="classVERTEX.html#a4d2943bb66a9923a6da9b065ca64984a">testKink</a>(<a class="code" href="classInitialConfiguration.html#a92297bc6de760f10ff2e8f4e25ecac0b">STI</a>);
<a name="l00966"></a>00966 }
<a name="l00967"></a>00967 
<a name="l00968"></a>00968 <span class="comment">//======================================================================</span>
<a name="l00969"></a>00969 
<a name="l00970"></a><a class="code" href="classInitialConfiguration.html#a513541c0b2800a99c35352af29ac8f32">00970</a> <span class="keywordtype">double</span> <a class="code" href="classInitialConfiguration.html#a513541c0b2800a99c35352af29ac8f32">InitialConfiguration::weight</a>() {
<a name="l00971"></a>00971   <span class="keywordtype">double</span> w = <a class="code" href="classInitialConfiguration.html#af8629ff71647bc503d20d9141e4da152">vertex_weight</a>() * <a class="code" href="classInitialConfiguration.html#a2cb856f19317a1d31a3c4670a914dfea">worm_weight</a>();
<a name="l00972"></a>00972   <span class="keywordflow">return</span> w;
<a name="l00973"></a>00973 }
<a name="l00974"></a>00974 
<a name="l00975"></a>00975 <span class="comment">//======================================================================</span>
<a name="l00976"></a>00976 
<a name="l00977"></a><a class="code" href="classInitialConfiguration.html#af8629ff71647bc503d20d9141e4da152">00977</a> <span class="keywordtype">double</span> <a class="code" href="classInitialConfiguration.html#af8629ff71647bc503d20d9141e4da152">InitialConfiguration::vertex_weight</a>() {
<a name="l00978"></a>00978   <span class="keywordtype">double</span> ws = <a class="code" href="classInitialConfiguration.html#a075af34a843191d8a1dc1cb9db262c8b">V</a>().<a class="code" href="classVERTEX.html#af56e280b2c94cebef5c80e6707062b18">Weight</a>[<a class="code" href="classInitialConfiguration.html#a92297bc6de760f10ff2e8f4e25ecac0b">STI</a>]; 
<a name="l00979"></a>00979   <span class="keywordflow">if</span> ( ! <a class="code" href="classInitialConfiguration.html#a0757ddb5fa3cf27ba383415646971d13">isKink</a>() ) ws += <a class="code" href="classInitialConfiguration.html#a075af34a843191d8a1dc1cb9db262c8b">V</a>().<a class="code" href="classVERTEX.html#ad5f4f052b92013a850af5f9ea527d8b5">EBASE</a>;
<a name="l00980"></a>00980   <span class="keywordflow">return</span> ws;
<a name="l00981"></a>00981 }
<a name="l00982"></a>00982 
<a name="l00983"></a>00983 <span class="comment">//======================================================================</span>
<a name="l00984"></a>00984 
<a name="l00985"></a><a class="code" href="classInitialConfiguration.html#a2cb856f19317a1d31a3c4670a914dfea">00985</a> <span class="keywordtype">double</span> <a class="code" href="classInitialConfiguration.html#a2cb856f19317a1d31a3c4670a914dfea">InitialConfiguration::worm_weight</a>() {
<a name="l00986"></a>00986   <span class="keywordtype">double</span> ww;
<a name="l00987"></a>00987   <span class="keywordflow">if</span> (<a class="code" href="classInitialConfiguration.html#a66e9afc35cfde27c7f2c650df188c0c8">INC</a> == <a class="code" href="namespaceDIR.html#a6af3477d2e74163c155b0d0a2e4265ae">DIR::UNDEF</a>) {
<a name="l00988"></a>00988     ww = 1.0;
<a name="l00989"></a>00989   } <span class="keywordflow">else</span> {
<a name="l00990"></a>00990     <span class="keywordtype">int</span> stype = <a class="code" href="classInitialConfiguration.html#a075af34a843191d8a1dc1cb9db262c8b">V</a>().<a class="code" href="classVERTEX.html#ab880edb46dac897b907057c56e65dfc7">SiteTypeOfLeg</a>[<a class="code" href="classInitialConfiguration.html#a66e9afc35cfde27c7f2c650df188c0c8">INC</a>];
<a name="l00991"></a>00991     <span class="keywordtype">int</span> ttype = <a class="code" href="classSite.html">Site</a>[stype].TTYPE;
<a name="l00992"></a>00992     <a class="code" href="classSOURCE.html">SOURCE</a>&amp; T = <a class="code" href="dla__alg_8h.html#a35f116b5f6905f314bc3858998e27dd2">Source</a>[ttype];
<a name="l00993"></a>00993     ww = T.<a class="code" href="classSOURCE.html#a9ba355badb4b5f534c7c29bd049d4358">Weight</a>( <a class="code" href="classInitialConfiguration.html#a8f747dc37066722ae97fb0edbb79ee71">XINC</a> , <a class="code" href="classInitialConfiguration.html#a1b922b6523bd302b3a36812b23c4eebb">State</a>[<a class="code" href="classInitialConfiguration.html#a66e9afc35cfde27c7f2c650df188c0c8">INC</a>] );
<a name="l00994"></a>00994   }
<a name="l00995"></a>00995   <span class="keywordflow">return</span> ww;
<a name="l00996"></a>00996 }
<a name="l00997"></a>00997 
<a name="l00998"></a>00998 <span class="comment">//======================================================================</span>
<a name="l00999"></a>00999 
<a name="l01000"></a><a class="code" href="classInitialConfiguration.html#accd2600060dbaee3a3b41aed4034c63c">01000</a> <span class="keywordtype">void</span> <a class="code" href="classInitialConfiguration.html#accd2600060dbaee3a3b41aed4034c63c">InitialConfiguration::dump</a>() {
<a name="l01001"></a>01001   <span class="keywordtype">double</span> wv,ww;
<a name="l01002"></a>01002   <span class="keywordflow">if</span> ( <a class="code" href="classInitialConfiguration.html#a66e9afc35cfde27c7f2c650df188c0c8">INC</a> == <a class="code" href="namespaceDIR.html#a6af3477d2e74163c155b0d0a2e4265ae">DIR::UNDEF</a> ) {
<a name="l01003"></a>01003     wv = 1.0;
<a name="l01004"></a>01004     ww = 1.0;
<a name="l01005"></a>01005   } <span class="keywordflow">else</span> {
<a name="l01006"></a>01006     wv = <a class="code" href="classInitialConfiguration.html#af8629ff71647bc503d20d9141e4da152">vertex_weight</a>();
<a name="l01007"></a>01007     ww = <a class="code" href="classInitialConfiguration.html#a2cb856f19317a1d31a3c4670a914dfea">worm_weight</a>();
<a name="l01008"></a>01008   }
<a name="l01009"></a>01009   printf(<span class="stringliteral">&quot; IC(%3d) : nleg= %2d, sti= %4d (&quot;</span>, <span class="keywordtype">id</span>(), <a class="code" href="classInitialConfiguration.html#ad2e978411f291e4018c6291e9d4a6deb">NLEG</a>, <a class="code" href="classInitialConfiguration.html#a92297bc6de760f10ff2e8f4e25ecac0b">STI</a>);
<a name="l01010"></a>01010   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classInitialConfiguration.html#ad2e978411f291e4018c6291e9d4a6deb">NLEG</a>; i++) {
<a name="l01011"></a>01011     printf(<span class="stringliteral">&quot; %1d&quot;</span>, <a class="code" href="classInitialConfiguration.html#a1b922b6523bd302b3a36812b23c4eebb">State</a>[i]);
<a name="l01012"></a>01012   }
<a name="l01013"></a>01013   printf(<span class="stringliteral">&quot;), inc= %2d, xinc= %2d &quot;</span>, <a class="code" href="classInitialConfiguration.html#a66e9afc35cfde27c7f2c650df188c0c8">INC</a>, <a class="code" href="classInitialConfiguration.html#a8f747dc37066722ae97fb0edbb79ee71">XINC</a>);
<a name="l01014"></a>01014   printf(<span class="stringliteral">&quot;--&gt; wv= %8.3f, ww= %8.3f, w= %8.3f\n&quot;</span>, wv, ww, wv*ww);
<a name="l01015"></a>01015   <span class="keywordflow">if</span> (<a class="code" href="classInitialConfiguration.html#abec7c8ef75bc4b811f2eb3d4e8db6d2b">NCH</a> != 0) {
<a name="l01016"></a>01016     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classInitialConfiguration.html#abec7c8ef75bc4b811f2eb3d4e8db6d2b">NCH</a>; i++) {
<a name="l01017"></a>01017       printf(<span class="stringliteral">&quot;   Channel[%d] : out= %d, xout= %d, prob= %8.3f\n&quot;</span>,
<a name="l01018"></a>01018         i, <a class="code" href="classInitialConfiguration.html#af60991908d4085d9b1282624853d053e">FinalDirection</a>[i], <a class="code" href="classInitialConfiguration.html#a228ef943ea00843456f11a742a1426aa">FinalState</a>[i], <a class="code" href="classInitialConfiguration.html#ab861732a67ffb9d9c9cc061b0d77faae">ScatteringProbability</a>[i]
<a name="l01019"></a>01019       );
<a name="l01020"></a>01020     }
<a name="l01021"></a>01021   }
<a name="l01022"></a>01022 }
<a name="l01023"></a>01023 
<a name="l01024"></a>01024 <span class="comment">//======================================================================</span>
<a name="l01025"></a>01025 
<a name="l01026"></a><a class="code" href="classInitialConfiguration.html#aac759501cf6c7895a70eecbef0226ae1">01026</a> <span class="keywordtype">void</span> <a class="code" href="classInitialConfiguration.html#aac759501cf6c7895a70eecbef0226ae1">InitialConfiguration::write</a>() {
<a name="l01027"></a>01027   <span class="keywordflow">if</span> ( ! <a class="code" href="classInitialConfiguration.html#afe93e17ac89cd97917811068ba2af214">isValid</a>() ) <span class="keywordflow">return</span>;
<a name="l01028"></a>01028   fprintf(<a class="code" href="dla__alg_8h.html#a58060d07f59ce3eff252924cf18e5d39">FALG</a>,<span class="stringliteral">&quot;\n&quot;</span>);
<a name="l01029"></a>01029   fprintf(<a class="code" href="dla__alg_8h.html#a58060d07f59ce3eff252924cf18e5d39">FALG</a>,<span class="stringliteral">&quot;    &lt;InitialConfiguration&gt;\n&quot;</span>);
<a name="l01030"></a>01030   fprintf(<a class="code" href="dla__alg_8h.html#a58060d07f59ce3eff252924cf18e5d39">FALG</a>,<span class="stringliteral">&quot;      &lt;State&gt; &quot;</span>);
<a name="l01031"></a>01031   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classInitialConfiguration.html#ad2e978411f291e4018c6291e9d4a6deb">NLEG</a>; i++) fprintf(<a class="code" href="dla__alg_8h.html#a58060d07f59ce3eff252924cf18e5d39">FALG</a>,<span class="stringliteral">&quot; %d&quot;</span>, <a class="code" href="classInitialConfiguration.html#a1b922b6523bd302b3a36812b23c4eebb">State</a>[i]);
<a name="l01032"></a>01032   fprintf(<a class="code" href="dla__alg_8h.html#a58060d07f59ce3eff252924cf18e5d39">FALG</a>,<span class="stringliteral">&quot; &lt;/State&gt;\n&quot;</span>);
<a name="l01033"></a>01033   fprintf(<a class="code" href="dla__alg_8h.html#a58060d07f59ce3eff252924cf18e5d39">FALG</a>,<span class="stringliteral">&quot;      &lt;IncomingDirection&gt; %d &lt;/IncomingDirection&gt;\n&quot;</span>, <a class="code" href="classInitialConfiguration.html#a66e9afc35cfde27c7f2c650df188c0c8">INC</a>);
<a name="l01034"></a>01034   fprintf(<a class="code" href="dla__alg_8h.html#a58060d07f59ce3eff252924cf18e5d39">FALG</a>,<span class="stringliteral">&quot;      &lt;NewState&gt; %d &lt;/NewState&gt;\n&quot;</span>, <a class="code" href="classInitialConfiguration.html#a8f747dc37066722ae97fb0edbb79ee71">XINC</a>);
<a name="l01035"></a>01035   fprintf(<a class="code" href="dla__alg_8h.html#a58060d07f59ce3eff252924cf18e5d39">FALG</a>,<span class="stringliteral">&quot;      &lt;NumberOfChannels&gt; %d &lt;/NumberOfChannels&gt;\n&quot;</span>, <a class="code" href="classInitialConfiguration.html#abec7c8ef75bc4b811f2eb3d4e8db6d2b">NCH</a>);
<a name="l01036"></a>01036   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ch=0; ch&lt;<a class="code" href="classInitialConfiguration.html#abec7c8ef75bc4b811f2eb3d4e8db6d2b">NCH</a>; ch++) {
<a name="l01037"></a>01037     <span class="keywordtype">int</span> out = <a class="code" href="classInitialConfiguration.html#af60991908d4085d9b1282624853d053e">FinalDirection</a>[ch];
<a name="l01038"></a>01038     <span class="keywordtype">int</span> xout = <a class="code" href="classInitialConfiguration.html#a228ef943ea00843456f11a742a1426aa">FinalState</a>[ch];
<a name="l01039"></a>01039     <span class="keywordtype">double</span> p = <a class="code" href="classInitialConfiguration.html#ab861732a67ffb9d9c9cc061b0d77faae">ScatteringProbability</a>[ch];
<a name="l01040"></a>01040     fprintf(<a class="code" href="dla__alg_8h.html#a58060d07f59ce3eff252924cf18e5d39">FALG</a>,<span class="stringliteral">&quot;      &lt;Channel&gt; %4d %4d %24.16f &lt;/Channel&gt;\n&quot;</span>, out, xout, p );
<a name="l01041"></a>01041   }
<a name="l01042"></a>01042   fprintf(<a class="code" href="dla__alg_8h.html#a58060d07f59ce3eff252924cf18e5d39">FALG</a>,<span class="stringliteral">&quot;    &lt;/InitialConfiguration&gt;\n&quot;</span>);
<a name="l01043"></a>01043 }
<a name="l01044"></a>01044 
<a name="l01045"></a>01045 <span class="comment">//######################################################################</span>
<a name="l01046"></a>01046 
<a name="l01047"></a><a class="code" href="classQUANTITY.html#af8b2b5aa28e95ab6c30d43fd63cb4723">01047</a> <span class="keywordtype">void</span> <a class="code" href="classQUANTITY.html#af8b2b5aa28e95ab6c30d43fd63cb4723">QUANTITY::load</a>(<a class="code" href="classXML_1_1Block.html">XML::Block</a>&amp; X) {
<a name="l01048"></a>01048   <a class="code" href="classQUANTITY.html#af180e926633cde08a05ccbc3af397ee4">ID</a> = X[<span class="stringliteral">&quot;QTYPE&quot;</span>].<a class="code" href="classXML_1_1Block.html#afcd6370972fce7a0d9378c778f5f09c7">getInteger</a>();
<a name="l01049"></a>01049   <a class="code" href="classQUANTITY.html#acabb6ad9b502cdea108fc7d574ec62c4">NAME</a> = X[<span class="stringliteral">&quot;Name&quot;</span>].<a class="code" href="classXML_1_1Block.html#a753440fc57aae094f400478d07277a73">getString</a>();
<a name="l01050"></a>01050   <a class="code" href="classQUANTITY.html#ad2dda4b775e3c53250d884ce4ff85a06">Value</a>.<a class="code" href="classArray.html#a5fd83b4910658540977272a168cfbdae">init</a>(2,<a class="code" href="dla__alg_8h.html#a2dad84a8985d20913d523848ae5e40ea">NSTYPE</a>,<a class="code" href="dla__alg_8h.html#a52b41a08e36114fbb78f5d900f0371b9">NXMAX</a>);
<a name="l01051"></a>01051   <a class="code" href="classQUANTITY.html#ad2dda4b775e3c53250d884ce4ff85a06">Value</a>.<a class="code" href="classArray.html#a46c36a9a7be294d4f647798d07c79c7e">set_all</a>(0.0);
<a name="l01052"></a>01052   <a class="code" href="classQUANTITY.html#ae42ce2c0562e399cba070105e28fe3d1">isDefined</a>.<a class="code" href="classArray.html#a5fd83b4910658540977272a168cfbdae">init</a>(2,<a class="code" href="dla__alg_8h.html#a2dad84a8985d20913d523848ae5e40ea">NSTYPE</a>,<a class="code" href="dla__alg_8h.html#a52b41a08e36114fbb78f5d900f0371b9">NXMAX</a>);
<a name="l01053"></a>01053   <a class="code" href="classQUANTITY.html#ae42ce2c0562e399cba070105e28fe3d1">isDefined</a>.<a class="code" href="classArray.html#a46c36a9a7be294d4f647798d07c79c7e">set_all</a>(<span class="keyword">false</span>);
<a name="l01054"></a>01054   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;X.<a class="code" href="classXML_1_1Block.html#a88796becd473f212deb450ad1a31a893">NumberOfBlocks</a>(); i++) {
<a name="l01055"></a>01055     <a class="code" href="classXML_1_1Block.html">XML::Block</a>&amp; B = X[i];
<a name="l01056"></a>01056     <span class="keywordflow">if</span> ( B.<a class="code" href="classXML_1_1Block.html#a8cf4db36c9f3123506d73e98c4a93464">getName</a>() == <span class="stringliteral">&quot;Value&quot;</span> ) {
<a name="l01057"></a>01057       <span class="keywordtype">int</span> st = B.<a class="code" href="classXML_1_1Block.html#afcd6370972fce7a0d9378c778f5f09c7">getInteger</a>(0);
<a name="l01058"></a>01058       <span class="keywordtype">int</span> x = B.<a class="code" href="classXML_1_1Block.html#afcd6370972fce7a0d9378c778f5f09c7">getInteger</a>(1);
<a name="l01059"></a>01059       <span class="keywordtype">double</span> v = B.<a class="code" href="classXML_1_1Block.html#a0bf14d82466b0e2b1ebff36333d0ad25">getDouble</a>(2);
<a name="l01060"></a>01060       <a class="code" href="classQUANTITY.html#ae42ce2c0562e399cba070105e28fe3d1">isDefined</a>(st,x) = <span class="keyword">true</span>;
<a name="l01061"></a>01061       <a class="code" href="classQUANTITY.html#ad2dda4b775e3c53250d884ce4ff85a06">Value</a>(st,x) = v;
<a name="l01062"></a>01062     }
<a name="l01063"></a>01063   }
<a name="l01064"></a>01064 }
<a name="l01065"></a>01065 
<a name="l01066"></a>01066 <span class="comment">//======================================================================</span>
<a name="l01067"></a>01067 
<a name="l01068"></a><a class="code" href="classQUANTITY.html#aac759501cf6c7895a70eecbef0226ae1">01068</a> <span class="keywordtype">void</span> <a class="code" href="classQUANTITY.html#aac759501cf6c7895a70eecbef0226ae1">QUANTITY::write</a>() {
<a name="l01069"></a>01069   fprintf(<a class="code" href="dla__alg_8h.html#a58060d07f59ce3eff252924cf18e5d39">FALG</a>,<span class="stringliteral">&quot;\n&quot;</span>);
<a name="l01070"></a>01070   fprintf(<a class="code" href="dla__alg_8h.html#a58060d07f59ce3eff252924cf18e5d39">FALG</a>,<span class="stringliteral">&quot;  &lt;Quantity&gt;\n&quot;</span>);
<a name="l01071"></a>01071   fprintf(<a class="code" href="dla__alg_8h.html#a58060d07f59ce3eff252924cf18e5d39">FALG</a>,<span class="stringliteral">&quot;    &lt;QTYPE&gt; %d &lt;/QTYPE&gt;\n&quot;</span>, <a class="code" href="classQUANTITY.html#aea93026f92028ac88f6b60cd2f3e438b">getID</a>());
<a name="l01072"></a>01072   fprintf(<a class="code" href="dla__alg_8h.html#a58060d07f59ce3eff252924cf18e5d39">FALG</a>,<span class="stringliteral">&quot;    &lt;Name&gt; %s &lt;/Name&gt;\n&quot;</span>, <a class="code" href="classQUANTITY.html#aa1e3f15b37a840cae70bbdd7e10fb40f">getName</a>().c_str());
<a name="l01073"></a>01073   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> st=0; st&lt;<a class="code" href="dla__alg_8h.html#a2dad84a8985d20913d523848ae5e40ea">NSTYPE</a>; st++) {
<a name="l01074"></a>01074     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> x=0; x&lt;<a class="code" href="dla__alg_8h.html#a52b41a08e36114fbb78f5d900f0371b9">NXMAX</a>; x++) {
<a name="l01075"></a>01075       <span class="keywordflow">if</span> ( <a class="code" href="classQUANTITY.html#ae42ce2c0562e399cba070105e28fe3d1">isDefined</a>(st,x) ) {
<a name="l01076"></a>01076         fprintf(<a class="code" href="dla__alg_8h.html#a58060d07f59ce3eff252924cf18e5d39">FALG</a>,<span class="stringliteral">&quot;    &lt;Value&gt; %d %d %24.16f &lt;/Value&gt;\n&quot;</span>,
<a name="l01077"></a>01077           st, x, <a class="code" href="classQUANTITY.html#ad2dda4b775e3c53250d884ce4ff85a06">Value</a>(st,x));
<a name="l01078"></a>01078       }
<a name="l01079"></a>01079     }
<a name="l01080"></a>01080   }
<a name="l01081"></a>01081   fprintf(<a class="code" href="dla__alg_8h.html#a58060d07f59ce3eff252924cf18e5d39">FALG</a>,<span class="stringliteral">&quot;  &lt;/Quantity&gt;\n&quot;</span>);
<a name="l01082"></a>01082 }
<a name="l01083"></a>01083 
<a name="l01084"></a>01084 <span class="comment">//######################################################################</span>
<a name="l01085"></a>01085 
<a name="l01086"></a>01086 <span class="comment">//######################################################################</span>
<a name="l01087"></a>01087 
<a name="l01088"></a><a class="code" href="dla__alg_8h.html#aeab06fd759525e7c94929ec5ed89a974">01088</a> <span class="keywordtype">void</span> <a class="code" href="dla__alg_8cc.html#aeab06fd759525e7c94929ec5ed89a974">SolveWeightEquation</a>(<span class="keywordtype">int</span> N, <a class="code" href="classArray.html">Array&lt;double&gt;</a>&amp; V, <a class="code" href="classArray.html">Array&lt;double&gt;</a>&amp; W) {
<a name="l01089"></a>01089 
<a name="l01090"></a>01090 <span class="comment">/*</span>
<a name="l01091"></a>01091 <span class="comment">  for (int i=0; i&lt;N; i++) {</span>
<a name="l01092"></a>01092 <span class="comment">    printf(&quot;V[%d] = %8.3f\n&quot;, i, V[i]);</span>
<a name="l01093"></a>01093 <span class="comment">  }</span>
<a name="l01094"></a>01094 <span class="comment">*/</span>
<a name="l01095"></a>01095 
<a name="l01096"></a>01096   W.<a class="code" href="classArray.html#a46c36a9a7be294d4f647798d07c79c7e">set_all</a>(0.0);
<a name="l01097"></a>01097 
<a name="l01098"></a>01098   <span class="keywordtype">int</span> p,q;
<a name="l01099"></a>01099   <span class="keywordtype">double</span> V_first;
<a name="l01100"></a>01100   <span class="keywordtype">double</span> V_second;
<a name="l01101"></a>01101   <span class="keywordtype">double</span> V_third;
<a name="l01102"></a>01102   <span class="keywordtype">double</span> V_first_new;
<a name="l01103"></a>01103   <span class="keywordtype">double</span> V_second_new;
<a name="l01104"></a>01104   <span class="keywordtype">int</span> N_first;   <span class="comment">// the number of the largest elements</span>
<a name="l01105"></a>01105   <span class="keywordtype">int</span> N_second;  <span class="comment">// the number of the second largest</span>
<a name="l01106"></a>01106 
<a name="l01107"></a>01107 <span class="comment">// èdï°ÇÇÕÇ‘Ç¢Çƒç≈èâÇ©ÇÁÇRÇ¬ÇÃèdÇ›Ç∆ÇªÇÃî‘çÜÇéÊìæÅD</span>
<a name="l01108"></a>01108   <span class="keywordflow">while</span> ( V[1] &gt; <a class="code" href="name_8h.html#a6ebf6899d6c1c8b7b9d09be872c05aae">EPS</a> ) {
<a name="l01109"></a>01109     V_first = V[0];
<a name="l01110"></a>01110     <span class="keywordflow">for</span> (p=0; p&lt;N; p++) <span class="keywordflow">if</span> ( V[p] != V_first ) <span class="keywordflow">break</span>;
<a name="l01111"></a>01111     N_first = p;
<a name="l01112"></a>01112     <span class="keywordflow">if</span> ( p == N ) {
<a name="l01113"></a>01113       V_second = 0.0;
<a name="l01114"></a>01114       V_third = 0.0;
<a name="l01115"></a>01115       N_second = 0;
<a name="l01116"></a>01116     } <span class="keywordflow">else</span> {
<a name="l01117"></a>01117       V_second = V[p];
<a name="l01118"></a>01118       <span class="keywordflow">for</span> (q=p; q&lt;N; q++) <span class="keywordflow">if</span> ( V[q] != V_second ) <span class="keywordflow">break</span>;
<a name="l01119"></a>01119       <span class="keywordflow">if</span> ( q == N ) {
<a name="l01120"></a>01120         V_third = 0.0;
<a name="l01121"></a>01121       } <span class="keywordflow">else</span> {
<a name="l01122"></a>01122         V_third = V[q];
<a name="l01123"></a>01123       }
<a name="l01124"></a>01124       N_second = q-p;
<a name="l01125"></a>01125     }
<a name="l01126"></a>01126 
<a name="l01127"></a>01127 <span class="comment">//à»â∫Ç≈ÇÕÅCV[i] &lt;= w_i Ç©ÇÁèoî≠ÇµÇƒÅCW(i,j) = w_{ij} Çèáéüëùâ¡Ç≥ÇπÇ»Ç™ÇÁÅC</span>
<a name="l01128"></a>01128 <span class="comment">//ÇªÇÃï™ÅCV[i] Çâ∫Ç∞ÇƒÇ¢Ç≠ÅDÇ∑Ç◊ÇƒÇÃ V[i] Ç™ÇOÇ…Ç»Ç¡ÇΩÇÁèIóπÅD</span>
<a name="l01129"></a>01129 
<a name="l01130"></a>01130     <span class="keywordtype">double</span> dw1; <span class="comment">// decrement of the first largest element</span>
<a name="l01131"></a>01131     <span class="keywordtype">double</span> dw2; <span class="comment">// decrement of the second largest element</span>
<a name="l01132"></a>01132     <span class="keywordflow">if</span> ( N_first == 1 ) {  
<a name="l01133"></a>01133 <span class="comment">//ç≈ëÂÉEÉFÉCÉgÇ™íPì∆ÇÃèÛë‘ÇÃÇ∆Ç´ÅCç≈ëÂÉEÉFÉCÉgÇ∆ëÊÇQÉEÉFÉCÉgÇÃä‘ÇÃëJà⁄Ç</span>
<a name="l01134"></a>01134 <span class="comment">//ì±ì¸ÇµÇƒÇªÇÍÇÁÇâ∫Ç∞ÇÈÅD</span>
<a name="l01135"></a>01135       <span class="keywordtype">double</span> x = V_first - V_second;
<a name="l01136"></a>01136       <span class="keywordtype">double</span> y = (double)(N_second - 1) * (V_second - V_third);
<a name="l01137"></a>01137       <span class="keywordflow">if</span> ( x &lt; y ) { 
<a name="l01138"></a>01138 <span class="comment">//ç≈ëÂÉEÉFÉCÉgÇ™ëÂÇ´Ç≠Ç»Ç¢Ç∆Ç´ÅCç≈ëÂÉEÉFÉCÉgÇ™ëÊÇQÉEÉFÉCÉgÇ…ìôÇµÇ≠Ç»ÇÈÇ‹Ç≈â∫Ç∞ÇÈÅD</span>
<a name="l01139"></a>01139         dw1 = (V_first-V_second) / ( 1.0 - 1.0 / (<span class="keywordtype">double</span>)(N_second));
<a name="l01140"></a>01140         dw2 = dw1 / (double)N_second;
<a name="l01141"></a>01141         V_second_new = V_second - dw2;
<a name="l01142"></a>01142         V_first_new  = V_second_new;
<a name="l01143"></a>01143       } <span class="keywordflow">else</span> { 
<a name="l01144"></a>01144 <span class="comment">// ç≈ëÂÉEÉFÉCÉgÇ™ëÂÇ´Ç¢Ç∆Ç´ÅCëÊÇQÉEÉFÉCÉgÇ™ëÊÇRÉEÉFÉCÉgÇ∆ìôÇµÇ≠Ç»ÇÈÇ‹Ç≈â∫Ç∞ÇÈÅD</span>
<a name="l01145"></a>01145         dw2 = V_second - V_third;
<a name="l01146"></a>01146         dw1 = dw2 * (double)N_second;
<a name="l01147"></a>01147         V_second_new = V_third;
<a name="l01148"></a>01148         V_first_new  = V_first - dw1;
<a name="l01149"></a>01149       }
<a name="l01150"></a>01150       V[0] = V_first_new;
<a name="l01151"></a>01151       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=1; i&lt;1+N_second; i++) {
<a name="l01152"></a>01152         W(0,i) += dw2;
<a name="l01153"></a>01153         W(i,0) += dw2;
<a name="l01154"></a>01154         V[i] = V_second_new;
<a name="l01155"></a>01155       }
<a name="l01156"></a>01156     } <span class="keywordflow">else</span> { 
<a name="l01157"></a>01157 <span class="comment">//ï°êîÇÃèÛë‘Ç™ç≈ëÂÉEÉFÉCÉgÇÇ∆ÇÈÇ∆Ç´ÅCëäå›Ç…à⁄ÇËïœÇÌÇÈëJà⁄ämó¶Çì±ì¸ÇµÇƒÅC</span>
<a name="l01158"></a>01158 <span class="comment">//ÇªÇÍÇÁÇëÊÇQÉEÉFÉCÉgÇ∆ìØÇ∂Ç…Ç»ÇÈÇ‹Ç≈â∫Ç∞ÇÈÅD</span>
<a name="l01159"></a>01159       dw1 = (V_first - V_second) / (<span class="keywordtype">double</span>)( N_first-1 );
<a name="l01160"></a>01160       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;N_first; i++) {
<a name="l01161"></a>01161         V[i] = V_second;
<a name="l01162"></a>01162         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;N_first; j++) {
<a name="l01163"></a>01163           <span class="keywordflow">if</span> ( i==j ) <span class="keywordflow">continue</span>;
<a name="l01164"></a>01164           W(i,j) += dw1;
<a name="l01165"></a>01165         }
<a name="l01166"></a>01166       }
<a name="l01167"></a>01167     }
<a name="l01168"></a>01168   }
<a name="l01169"></a>01169   <span class="keywordflow">if</span> ( V[0] &gt; 0.0 ) {
<a name="l01170"></a>01170     W(0,0) += V[0];
<a name="l01171"></a>01171     V[0] = 0.0;
<a name="l01172"></a>01172   }
<a name="l01173"></a>01173 
<a name="l01174"></a>01174 }
<a name="l01175"></a>01175 
<a name="l01176"></a>01176 <span class="comment">//======================================================================</span>
<a name="l01177"></a>01177 
<a name="l01178"></a><a class="code" href="dla__alg_8h.html#ac16b7b50b923317227f20002e977d596">01178</a> <span class="keywordtype">void</span> <a class="code" href="dla__alg_8cc.html#ac16b7b50b923317227f20002e977d596">bubble_sort</a>(<span class="keywordtype">int</span> N, <a class="code" href="classArray.html">Array&lt;double&gt;</a>&amp; V, <a class="code" href="classArray.html">Array&lt;int&gt;</a>&amp; I) {
<a name="l01179"></a>01179   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;N; i++) I[i] = i;
<a name="l01180"></a>01180   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;N-1; i++) {
<a name="l01181"></a>01181     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=i+1; j&lt;N; j++) {
<a name="l01182"></a>01182       <span class="keywordflow">if</span> ( V[I[i]] &lt; V[I[j]] ) {
<a name="l01183"></a>01183         <span class="keywordtype">int</span> ii = I[i];
<a name="l01184"></a>01184         I[i] = I[j];
<a name="l01185"></a>01185         I[j] = ii;
<a name="l01186"></a>01186       }
<a name="l01187"></a>01187     }
<a name="l01188"></a>01188   }
<a name="l01189"></a>01189 }
</pre></div></div><!-- contents -->
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>ÂÖ®„Å¶</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>„ÇØ„É©„Çπ</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>„Éç„Éº„É†„Çπ„Éö„Éº„Çπ</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>„Éï„Ç°„Ç§„É´</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Èñ¢Êï∞</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Â§âÊï∞</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>ÂûãÂÆöÁæ©</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>ÂàóÊåôÂûã„ÅÆÂÄ§</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>„Éï„É¨„É≥„Éâ</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>„Éû„ÇØ„É≠ÂÆöÁæ©</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="dla__alg_8cc.html">dla_alg.cc</a>      </li>

    <li class="footer">DSQSS„Å´ÂØæ„Åó„Å¶Thu Jul 12 2012 14:28:53„Å´ÁîüÊàê„Åï„Çå„Åæ„Åó„Åü„ÄÇ
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.6.1 </li>
   </ul>
 </div>


</body>
</html>
